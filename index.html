<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">
<title>‡¶Ü‡¶¨‡¶π‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶æ‡¶≠‡¶æ‡¶∏ ‚Äî ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂</title>
<link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  FIREBASE CONFIG ‚Äî ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ Firebase Console ‡¶•‡ßá‡¶ï‡ßá ‡¶è‡¶á
  ‡¶Æ‡¶æ‡¶®‡¶ó‡ßÅ‡¶≤‡ßã ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∏‡ßç‡¶•‡¶æ‡¶™‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§
  Project Settings ‚Üí Your Apps ‚Üí Firebase SDK snippet
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<script type="module">
import { initializeApp }              from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getFirestore, doc, setDoc,
         getDoc, serverTimestamp }    from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

// ‚îÄ‚îÄ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ config ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶¨‡¶∏‡¶æ‡¶® ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const firebaseConfig = {
  apiKey: "AIzaSyBkI1L32ouLDkZbQaXjR5f35HWhsVZ8Kbg",
  authDomain: "suraksha-4f141.firebaseapp.com",
  projectId: "suraksha-4f141",
  storageBucket: "suraksha-4f141.firebasestorage.app",
  messagingSenderId: "1009022095366",
  appId: "1:1009022095366:web:3e8149e8919ee7cbe4b387",
  measurementId: "G-ZD9K5ZQMKZ"
};

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

const app = initializeApp(firebaseConfig);
const db  = getFirestore(app);

// ‚îÄ‚îÄ‚îÄ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶® (user portal) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
window._fbSaveCase = async function(caseId, data) {
  await setDoc(doc(db, "cases", caseId), {
    ...data,
    savedAt: serverTimestamp(),
  });
};

// ‚îÄ‚îÄ‚îÄ Case ID ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶ñ‡ßã‡¶Å‡¶ú (track tab) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
window._fbGetCase = async function(caseId) {
  const snap = await getDoc(doc(db, "cases", caseId));
  return snap.exists() ? snap.data() : null;
};
</script>
<style>
:root{--bg:#060d14;--surface:#0a1520;--card:#0e1e2e;--card2:#122030;--border:#1c3348;--border2:#254460;--teal:#0891b2;--teal2:#06b6d4;--teal3:#67e8f9;--gold:#d97706;--gold2:#f59e0b;--green:#10b981;--red:#ef4444;--red2:#fca5a5;--text:#e0eaf5;--text2:#a8c0d6;--muted:#5a7a96;--mono:'JetBrains Mono',monospace;--sans:'Hind Siliguri',sans-serif;--radius:14px;--shadow:0 8px 32px rgba(0,0,0,.4);}
*{margin:0;padding:0;box-sizing:border-box;}
html{scroll-behavior:smooth;}
body{background:var(--bg);color:var(--text);font-family:var(--sans);min-height:100vh;overflow-x:hidden;line-height:1.6;}
body::before{content:'';position:fixed;inset:0;pointer-events:none;z-index:0;background:radial-gradient(ellipse 60% 40% at 20% 20%,rgba(8,145,178,.06) 0%,transparent 70%),radial-gradient(ellipse 50% 50% at 80% 80%,rgba(6,182,212,.04) 0%,transparent 70%);}
#panic-btn{position:fixed;top:14px;right:16px;z-index:9999;background:rgba(239,68,68,.15);border:1.5px solid rgba(239,68,68,.35);border-radius:40px;padding:8px 16px;display:flex;align-items:center;gap:7px;font-family:var(--sans);font-size:.78rem;font-weight:600;color:#fca5a5;cursor:pointer;transition:all .2s;backdrop-filter:blur(12px);}
#panic-btn:hover{background:rgba(239,68,68,.3);border-color:rgba(239,68,68,.6);transform:scale(1.04);}
#panic-btn .panic-dot{width:7px;height:7px;border-radius:50%;background:#ef4444;animation:blink 1.2s ease infinite;}
@keyframes blink{0%,100%{opacity:1;}50%{opacity:.3;}}
#disguise{display:none;position:fixed;inset:0;z-index:99999;background:#fff;color:#111;font-family:Arial,sans-serif;}
#disguise-inner{max-width:800px;margin:0 auto;padding:40px 20px;}
#disguise h1{font-size:1.5rem;color:#0066cc;margin-bottom:16px;}
#disguise p{font-size:.9rem;line-height:1.8;color:#333;}
#timer-bar{position:fixed;top:0;left:0;right:0;height:2px;z-index:1000;background:rgba(8,145,178,.15);}
#timer-fill{height:100%;background:linear-gradient(90deg,var(--teal),var(--teal2));width:100%;transition:width 1s linear;}
#header{position:fixed;top:0;left:0;right:0;z-index:100;background:rgba(6,13,20,.88);backdrop-filter:blur(20px);border-bottom:1px solid var(--border);padding:13px 20px;display:flex;align-items:center;gap:14px;}
.logo-mark{width:34px;height:34px;border-radius:8px;flex-shrink:0;background:linear-gradient(135deg,var(--teal),var(--teal2));display:flex;align-items:center;justify-content:center;font-size:17px;box-shadow:0 0 16px rgba(8,145,178,.4);}
.logo-text{font-weight:700;font-size:1rem;letter-spacing:.3px;}
.logo-sub{font-size:.68rem;color:var(--muted);font-family:var(--mono);}
.anon-pill{margin-left:auto;margin-right:80px;display:flex;align-items:center;gap:6px;background:rgba(16,185,129,.08);border:1px solid rgba(16,185,129,.25);border-radius:20px;padding:5px 12px;font-size:.7rem;color:#6ee7b7;font-family:var(--mono);}
.green-dot{width:6px;height:6px;border-radius:50%;background:#10b981;animation:pulse-g 2s ease infinite;}
@keyframes pulse-g{0%,100%{opacity:1;}50%{opacity:.3;}}
main{position:relative;z-index:1;padding-top:68px;max-width:860px;margin:0 auto;padding-left:18px;padding-right:18px;}
.hero{padding:44px 0 28px;text-align:center;}
.hero-icon{font-size:3.2rem;display:block;margin-bottom:14px;filter:drop-shadow(0 0 20px rgba(8,145,178,.5));animation:levitate 5s ease-in-out infinite;}
@keyframes levitate{0%,100%{transform:translateY(0);}50%{transform:translateY(-7px);}}
.hero h1{font-size:clamp(1.6rem,4.5vw,2.4rem);font-weight:700;line-height:1.25;margin-bottom:10px;}
.hero h1 em{font-style:normal;color:var(--teal2);}
.hero-sub{font-size:.92rem;color:var(--text2);max-width:480px;margin:0 auto 8px;line-height:1.65;}
.hero-esc-hint{font-size:.72rem;color:var(--muted);font-family:var(--mono);margin-bottom:28px;}
.badges{display:flex;flex-wrap:wrap;gap:8px;justify-content:center;margin-bottom:36px;}
.badge{display:flex;align-items:center;gap:5px;background:var(--card);border:1px solid var(--border);border-radius:20px;padding:5px 12px;font-size:.73rem;color:var(--text2);}
.badge span{font-size:.9rem;}
.card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:24px;margin-bottom:16px;position:relative;overflow:hidden;box-shadow:var(--shadow);}
.card::before{content:'';position:absolute;left:0;top:0;bottom:0;width:3px;background:linear-gradient(180deg,var(--teal),var(--teal2));border-radius:3px 0 0 3px;}
.card-title{font-size:.97rem;font-weight:700;margin-bottom:4px;display:flex;align-items:center;gap:8px;}
.card-sub{font-size:.78rem;color:var(--muted);margin-bottom:18px;line-height:1.5;}
.step-num{width:24px;height:24px;border-radius:50%;background:linear-gradient(135deg,var(--teal),var(--teal2));display:flex;align-items:center;justify-content:center;font-size:.72rem;font-weight:700;font-family:var(--mono);flex-shrink:0;}
label{display:block;font-size:.78rem;font-weight:600;color:var(--muted);margin-bottom:5px;letter-spacing:.3px;}
label.req::after{content:' *';color:var(--gold2);}
input[type=text],input[type=password],textarea,select{width:100%;background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:11px 14px;color:var(--text);font-family:var(--sans);font-size:.88rem;outline:none;transition:border-color .2s,box-shadow .2s;margin-bottom:14px;}
input:focus,textarea:focus,select:focus{border-color:var(--teal);box-shadow:0 0 0 3px rgba(8,145,178,.12);}
textarea{resize:vertical;min-height:120px;line-height:1.65;}
select option{background:var(--surface);}
.check-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(165px,1fr));gap:7px;margin-bottom:14px;}
.check-item{display:flex;align-items:center;gap:7px;background:var(--surface);border:1px solid var(--border);border-radius:8px;padding:9px 11px;cursor:pointer;font-size:.79rem;transition:all .18s;}
.check-item:hover{border-color:var(--teal);background:rgba(8,145,178,.06);}
.check-item.on{border-color:var(--teal2);background:rgba(6,182,212,.1);color:var(--teal3);}
.check-item input{accent-color:var(--teal2);width:14px;height:14px;cursor:pointer;}
.radio-row{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:14px;}
.radio-opt{display:flex;align-items:center;gap:6px;background:var(--surface);border:1px solid var(--border);border-radius:8px;padding:8px 13px;cursor:pointer;font-size:.79rem;transition:all .18s;}
.radio-opt:hover{border-color:var(--teal);}
.radio-opt.on{border-color:var(--teal2);background:rgba(6,182,212,.1);color:var(--teal3);}
.radio-opt input{display:none;}
.drop-zone{border:2px dashed var(--border);border-radius:10px;padding:24px;text-align:center;cursor:pointer;transition:all .25s;margin-bottom:12px;position:relative;}
.drop-zone:hover,.drop-zone.over{border-color:var(--teal);background:rgba(8,145,178,.05);}
.drop-zone input{position:absolute;inset:0;opacity:0;cursor:pointer;}
.drop-icon{font-size:1.8rem;margin-bottom:6px;}
.drop-txt{font-size:.82rem;color:var(--muted);}
.file-rows{display:flex;flex-direction:column;gap:5px;margin-top:10px;}
.file-row{display:flex;align-items:center;gap:8px;background:var(--surface);border:1px solid var(--border);border-radius:7px;padding:7px 10px;font-size:.78rem;}
.file-hash{font-family:var(--mono);font-size:.62rem;color:var(--teal);opacity:.8;margin-top:1px;}
.rm-file{margin-left:auto;cursor:pointer;color:var(--muted);transition:color .15s;font-size:.9rem;}
.rm-file:hover{color:var(--red);}
.priv-box{display:flex;gap:10px;background:rgba(16,185,129,.05);border:1px solid rgba(16,185,129,.2);border-radius:10px;padding:13px;margin-bottom:14px;font-size:.77rem;color:#86efac;line-height:1.6;}
.priv-icon{font-size:1.1rem;flex-shrink:0;margin-top:1px;}
#live-risk{display:none;margin-bottom:14px;}
.risk-wrap{background:var(--card2);border:1px solid var(--border);border-radius:10px;padding:14px;}
.risk-top{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px;}
.risk-label-sm{font-size:.75rem;font-weight:600;color:var(--muted);}
.rbar{height:7px;background:var(--surface);border-radius:4px;overflow:hidden;}
.rbar-fill{height:100%;border-radius:4px;transition:width .5s ease,background .5s ease;}
.risk-note{font-size:.72rem;color:var(--muted);margin-top:6px;}
#ai-section{display:none;}
.chat-box{background:var(--surface);border:1px solid var(--border);border-radius:10px;height:320px;overflow-y:auto;padding:14px;margin-bottom:10px;scroll-behavior:smooth;}
.chat-box::-webkit-scrollbar{width:4px;}
.chat-box::-webkit-scrollbar-track{background:transparent;}
.chat-box::-webkit-scrollbar-thumb{background:var(--border2);border-radius:2px;}
.msg{margin-bottom:12px;animation:fadein .3s ease;}
@keyframes fadein{from{opacity:0;transform:translateY(4px);}to{opacity:1;transform:none;}}
.msg-ai{display:flex;gap:8px;}
.msg-ai-icon{width:28px;height:28px;border-radius:50%;background:linear-gradient(135deg,var(--teal),var(--teal2));display:flex;align-items:center;justify-content:center;font-size:13px;flex-shrink:0;margin-top:2px;}
.msg-ai-bubble{background:var(--card2);border:1px solid var(--border);border-radius:0 10px 10px 10px;padding:10px 13px;font-size:.83rem;line-height:1.65;max-width:88%;}
.msg-user{display:flex;justify-content:flex-end;}
.msg-user-bubble{background:rgba(8,145,178,.15);border:1px solid rgba(8,145,178,.25);border-radius:10px 0 10px 10px;padding:9px 13px;font-size:.82rem;line-height:1.6;max-width:85%;color:var(--teal3);}
.typing{display:flex;gap:4px;padding:8px 4px;}
.typing span{width:6px;height:6px;border-radius:50%;background:var(--teal);animation:bounce .9s infinite;}
.typing span:nth-child(2){animation-delay:.2s;}
.typing span:nth-child(3){animation-delay:.4s;}
@keyframes bounce{0%,80%,100%{transform:translateY(0);}40%{transform:translateY(-6px);}}
.chat-input-row{display:flex;gap:8px;}
.chat-input-row input{flex:1;margin-bottom:0;}
.chat-send{background:linear-gradient(135deg,var(--teal),var(--teal2));border:none;border-radius:9px;padding:0 18px;color:#fff;font-family:var(--sans);font-size:.85rem;font-weight:600;cursor:pointer;transition:transform .15s,box-shadow .15s;white-space:nowrap;}
.chat-send:hover{transform:translateY(-1px);box-shadow:0 4px 14px rgba(8,145,178,.35);}
.chat-send:disabled{opacity:.45;cursor:not-allowed;transform:none;}
.submit-btn{width:100%;background:linear-gradient(135deg,var(--teal),var(--teal2));border:none;border-radius:12px;padding:15px;font-family:var(--sans);font-size:.98rem;font-weight:700;color:#fff;cursor:pointer;transition:transform .2s,box-shadow .2s;box-shadow:0 4px 20px rgba(8,145,178,.3);margin-top:4px;}
.submit-btn:hover{transform:translateY(-2px);box-shadow:0 8px 28px rgba(8,145,178,.45);}
.submit-btn:active{transform:none;}
.submit-btn:disabled{opacity:.5;cursor:not-allowed;transform:none;}
#result{display:none;}
.result-top{background:linear-gradient(135deg,rgba(8,145,178,.12),rgba(6,182,212,.07));border:1px solid rgba(8,145,178,.25);border-radius:16px;padding:28px;text-align:center;margin-bottom:18px;position:relative;overflow:hidden;}
.result-top::after{content:'';position:absolute;top:-60%;left:-60%;width:220%;height:220%;background:radial-gradient(circle,rgba(8,145,178,.06) 0%,transparent 55%);animation:spin-glow 12s linear infinite;pointer-events:none;}
@keyframes spin-glow{from{transform:rotate(0)}to{transform:rotate(360deg)}}
.caseid-box{font-family:var(--mono);font-size:1.25rem;font-weight:600;color:var(--teal2);background:rgba(8,145,178,.1);border:1px solid rgba(8,145,178,.3);border-radius:8px;padding:9px 18px;display:inline-flex;align-items:center;gap:10px;margin:10px 0;position:relative;z-index:1;}
.copy-btn{background:none;border:1px solid rgba(8,145,178,.35);border-radius:5px;padding:3px 9px;font-size:.65rem;color:var(--muted);cursor:pointer;font-family:var(--mono);transition:all .15s;}
.copy-btn:hover{border-color:var(--teal2);color:var(--teal3);}
.result-note{font-size:.78rem;color:var(--muted);position:relative;z-index:1;}
.result-grid{display:grid;gap:14px;}
.rblock{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:18px;}
.rblock-title{font-size:.82rem;font-weight:700;color:var(--gold2);margin-bottom:12px;display:flex;align-items:center;gap:6px;}
.action-row{display:flex;align-items:flex-start;gap:9px;padding:8px 0;border-bottom:1px solid rgba(255,255,255,.04);font-size:.82rem;line-height:1.55;}
.action-row:last-child{border:none;padding-bottom:0;}
.anum{min-width:20px;height:20px;border-radius:50%;background:rgba(8,145,178,.2);color:var(--teal3);display:flex;align-items:center;justify-content:center;font-size:.65rem;font-weight:700;font-family:var(--mono);flex-shrink:0;}
.ref-card{display:flex;align-items:center;gap:10px;background:var(--surface);border:1px solid var(--border);border-radius:9px;padding:11px 13px;margin-bottom:7px;cursor:pointer;transition:all .18s;}
.ref-card:hover{border-color:var(--teal);transform:translateX(3px);}
.ref-icon2{font-size:1.4rem;}
.ref-name2{font-weight:600;font-size:.84rem;}
.ref-num{font-family:var(--mono);font-size:.72rem;color:var(--teal2);margin-top:2px;}
.ref-tag-u{margin-left:auto;background:rgba(239,68,68,.12);border:1px solid rgba(239,68,68,.25);color:#fca5a5;border-radius:5px;padding:2px 7px;font-size:.65rem;font-family:var(--mono);}
.ref-tag-n{margin-left:auto;background:rgba(8,145,178,.1);border:1px solid rgba(8,145,178,.22);color:var(--teal3);border-radius:5px;padding:2px 7px;font-size:.65rem;font-family:var(--mono);}
.hash-row{background:rgba(0,0,0,.25);border-radius:6px;padding:7px 9px;font-family:var(--mono);font-size:.62rem;color:var(--teal);word-break:break-all;line-height:1.5;margin-bottom:5px;}
.rl-low{background:rgba(16,185,129,.1);border:1px solid rgba(16,185,129,.3);color:#6ee7b7;border-radius:5px;padding:3px 9px;font-size:.75rem;font-family:var(--mono);}
.rl-medium{background:rgba(245,158,11,.1);border:1px solid rgba(245,158,11,.3);color:#fde68a;border-radius:5px;padding:3px 9px;font-size:.75rem;font-family:var(--mono);}
.rl-high{background:rgba(239,68,68,.1);border:1px solid rgba(239,68,68,.3);color:#fca5a5;border-radius:5px;padding:3px 9px;font-size:.75rem;font-family:var(--mono);}
.rl-critical{background:rgba(239,68,68,.25);border:1px solid rgba(239,68,68,.5);color:#fff;border-radius:5px;padding:3px 9px;font-size:.75rem;font-family:var(--mono);animation:warn-blink 1.4s ease infinite;}
@keyframes warn-blink{0%,100%{opacity:1;}50%{opacity:.55;}}
.ai-analysis-box{background:rgba(8,145,178,.05);border:1px solid rgba(8,145,178,.2);border-radius:10px;padding:14px;margin-top:10px;font-size:.82rem;line-height:1.7;color:var(--text2);}
.ai-tag{font-size:.65rem;font-family:var(--mono);color:var(--teal2);letter-spacing:.5px;margin-bottom:6px;opacity:.8;}
.track-result{display:none;margin-top:12px;background:var(--surface);border:1px solid var(--border);border-radius:9px;padding:14px;font-size:.82rem;}
.track-badge{display:inline-block;border-radius:5px;padding:2px 9px;font-family:var(--mono);font-size:.72rem;margin-left:7px;}
.tb-active{background:rgba(8,145,178,.15);color:var(--teal2);border:1px solid rgba(8,145,178,.3);}
.tb-review{background:rgba(245,158,11,.1);color:#fcd34d;border:1px solid rgba(245,158,11,.3);}
.tb-resolved{background:rgba(16,185,129,.1);color:#86efac;border:1px solid rgba(16,185,129,.3);}
#loading-overlay{display:none;position:fixed;inset:0;z-index:400;background:rgba(6,13,20,.9);backdrop-filter:blur(10px);align-items:center;justify-content:center;flex-direction:column;gap:18px;}
#loading-overlay.on{display:flex;}
.spin{width:44px;height:44px;border-radius:50%;border:3px solid var(--border);border-top-color:var(--teal);animation:spin .9s linear infinite;}
@keyframes spin{to{transform:rotate(360deg)}}
.load-txt{font-size:.85rem;color:var(--muted);font-family:var(--mono);}
#toast{position:fixed;bottom:72px;left:50%;transform:translateX(-50%) translateY(12px);background:var(--card2);border:1px solid var(--teal);border-radius:9px;padding:10px 18px;font-size:.82rem;opacity:0;transition:all .25s;z-index:500;white-space:nowrap;pointer-events:none;}
#toast.on{opacity:1;transform:translateX(-50%) translateY(0);}
#inactivity-warn{display:none;position:fixed;bottom:70px;left:50%;transform:translateX(-50%);background:rgba(239,68,68,.15);border:1px solid rgba(239,68,68,.35);border-radius:9px;padding:10px 18px;font-size:.8rem;color:#fca5a5;z-index:600;font-family:var(--mono);text-align:center;}
.tabs{display:flex;gap:8px;margin-bottom:20px;border-bottom:1px solid var(--border);padding-bottom:0;}
.tab{padding:9px 16px;font-size:.82rem;font-weight:600;cursor:pointer;color:var(--muted);border-bottom:2px solid transparent;transition:all .2s;margin-bottom:-1px;}
.tab:hover{color:var(--text2);}
.tab.active{color:var(--teal2);border-bottom-color:var(--teal2);}
/* ‚îÄ‚îÄ‚îÄ THREAT SOLUTION CARDS ‚îÄ‚îÄ‚îÄ */
.threat-sol-section{margin-top:6px;}
.threat-sol-card{background:var(--surface);border:1px solid var(--border2);border-radius:10px;padding:14px;margin-bottom:10px;transition:border-color .2s;}
.threat-sol-card:hover{border-color:var(--teal);}
.threat-sol-hdr{display:flex;align-items:center;gap:8px;margin-bottom:10px;}
.threat-sol-icon{font-size:1.2rem;}
.threat-sol-title{font-size:.83rem;font-weight:700;color:var(--teal3);}
.threat-sol-steps{list-style:none;padding:0;}
.threat-sol-steps li{display:flex;align-items:flex-start;gap:8px;padding:6px 0;border-bottom:1px solid rgba(255,255,255,.04);font-size:.79rem;color:var(--text2);line-height:1.55;}
.threat-sol-steps li:last-child{border:none;}
.sol-num{min-width:18px;height:18px;border-radius:50%;background:rgba(6,182,212,.15);color:var(--teal2);display:flex;align-items:center;justify-content:center;font-size:.6rem;font-weight:700;flex-shrink:0;margin-top:2px;}
.db-status{display:inline-flex;align-items:center;gap:5px;background:rgba(16,185,129,.08);border:1px solid rgba(16,185,129,.2);border-radius:6px;padding:4px 10px;font-size:.65rem;font-family:var(--mono);color:#6ee7b7;margin-top:8px;}
@media(max-width:580px){.check-grid{grid-template-columns:1fr 1fr;}.badges{justify-content:flex-start;}.anon-pill{display:none;}}
</style>
</head>
<body>

<div id="timer-bar"><div id="timer-fill"></div></div>

<button id="panic-btn" onclick="PANIC()" title="‡¶§‡¶æ‡ßé‡¶ï‡ßç‡¶∑‡¶£‡¶ø‡¶ï ‡¶¨‡¶æ‡¶π‡¶ø‡¶∞ ‡¶π‡¶® (ESC√ó3)">
  <div class="panic-dot"></div>‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶¨‡¶æ‡¶π‡¶ø‡¶∞ ‡¶π‡¶®
</button>

<div id="disguise">
  <div id="disguise-inner">
    <h1>üå§ ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶Ü‡¶¨‡¶π‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ö‡¶ß‡¶ø‡¶¶‡¶™‡ßç‡¶§‡¶∞</h1>
    <h2 style="font-size:1.1rem;margin-bottom:12px;">‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶Ü‡¶¨‡¶π‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶æ‡¶≠‡¶æ‡¶∏</h2>
    <p>‡¶¢‡¶æ‡¶ï‡¶æ: ‡¶Ü‡¶Ç‡¶∂‡¶ø‡¶ï ‡¶Æ‡ßá‡¶ò‡¶≤‡¶æ, ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡ß©‡ßß¬∞C‡•§ ‡¶ö‡¶ü‡ßç‡¶ü‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ: ‡¶π‡¶æ‡¶≤‡¶ï‡¶æ ‡¶¨‡ßÉ‡¶∑‡ßç‡¶ü‡¶ø‡¶∞ ‡¶∏‡¶Æ‡ßç‡¶≠‡¶æ‡¶¨‡¶®‡¶æ, ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡ß®‡ßØ¬∞C‡•§ ‡¶∏‡¶ø‡¶≤‡ßá‡¶ü: ‡¶≠‡¶æ‡¶∞‡ßÄ ‡¶¨‡ßÉ‡¶∑‡ßç‡¶ü‡¶ø, ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡ß®‡ß≠¬∞C‡•§</p>
  </div>
</div>

<div id="loading-overlay"><div class="spin"></div><div class="load-txt" id="load-msg">‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶¶‡¶≠‡¶æ‡¶¨‡ßá ‡¶™‡ßç‡¶∞‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div></div>
<div id="toast"></div>
<div id="inactivity-warn">‚ö†Ô∏è ‡¶®‡¶ø‡¶∑‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º‡¶§‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶∞‡¶£‡ßá <span id="warn-sec">‡ß©‡ß¶</span> ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°‡ßá ‡¶™‡ßá‡¶á‡¶ú ‡¶¨‡¶®‡ßç‡¶ß ‡¶π‡¶¨‡ßá</div>

<div id="header">
  <div class="logo-mark">üõ°</div>
  <div>
    <div class="logo-text">‡¶∏‡ßÅ‡¶∞‡¶ï‡ßç‡¶∑‡¶æ</div>
    <div class="logo-sub">SURAKSHA v3 ¬∑ AI-Secured</div>
  </div>
  <div class="anon-pill"><div class="green-dot"></div>‡¶™‡¶∞‡¶ø‡¶ö‡¶Ø‡¶º ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶ó‡ßã‡¶™‡¶®</div>
</div>

<main>
  <div class="hero">
    <span class="hero-icon">üõ°</span>
    <h1>‡¶Ü‡¶™‡¶®‡¶ø ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶¶‡•§<br><em>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ï‡¶•‡¶æ ‡¶ó‡ßã‡¶™‡¶® ‡¶•‡¶æ‡¶ï‡¶¨‡ßá‡•§</em></h1>
    <p class="hero-sub">AI-‡¶ö‡¶æ‡¶≤‡¶ø‡¶§ ‡¶è‡¶á ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ, ‡¶´‡ßã‡¶® ‡¶¨‡¶æ ‡¶ï‡ßã‡¶®‡ßã ‡¶™‡¶∞‡¶ø‡¶ö‡¶Ø‡¶º ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶π‡¶Ø‡¶º ‡¶®‡¶æ‡•§ ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶® ‚Äî ‡¶¨‡¶æ‡¶ï‡¶ø ‡¶∏‡¶¨ ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶¶‡ßá‡¶ñ‡¶¨‡•§</p>
    <p class="hero-esc-hint">‚ö†Ô∏è ‡¶¨‡¶ø‡¶™‡¶¶ ‡¶Æ‡¶®‡ßá ‡¶π‡¶≤‡ßá ‡¶â‡¶™‡¶∞‡ßá‡¶∞ ‡¶≤‡¶æ‡¶≤ ‡¶¨‡ßã‡¶§‡¶æ‡¶Æ ‡¶¨‡¶æ ESC ‡¶§‡¶ø‡¶®‡¶¨‡¶æ‡¶∞ ‡¶ö‡¶æ‡¶™‡ßÅ‡¶®</p>
  </div>

  <div class="badges">
    <div class="badge"><span>üîê</span> ‡¶®‡¶æ‡¶Æ/‡¶´‡ßã‡¶® ‡¶®‡ßá‡¶á</div>
    <div class="badge"><span>‚õì</span> Blockchain ‡¶™‡ßç‡¶∞‡¶Æ‡¶æ‡¶£</div>
    <div class="badge"><span>ü§ñ</span> AI ‡¶¨‡¶ø‡¶∂‡ßç‡¶≤‡ßá‡¶∑‡¶£</div>
    <div class="badge"><span>‚è±</span> Auto-clear ‡ßß‡ß¶ ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü</div>
    <div class="badge"><span>üö™</span> ‡¶§‡¶æ‡ßé‡¶ï‡ßç‡¶∑‡¶£‡¶ø‡¶ï Panic Exit</div>
    <div class="badge"><span>üóÑ</span> ‡¶è‡¶®‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü‡ßá‡¶° DB ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£</div>
  </div>

  <div class="tabs">
    <div class="tab active" onclick="switchTab('report')">üìù ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</div>
    <div class="tab" onclick="switchTab('ai')">ü§ñ AI ‡¶∏‡¶π‡¶æ‡¶Ø‡¶º‡¶§‡¶æ</div>
    <div class="tab" onclick="switchTab('track')">üîç ‡¶ï‡ßá‡¶∏ ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®</div>
  </div>

  <!-- TAB: REPORT -->
  <div id="tab-report">
    <div class="card">
      <div class="card-title"><div class="step-num">‡ßß</div> ‡¶ò‡¶ü‡¶®‡¶æ‡¶∞ ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£</div>
      <div class="card-sub">‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá ‡¶§‡¶æ ‡¶®‡¶ø‡¶ú‡ßá‡¶∞ ‡¶≠‡¶æ‡¶∑‡¶æ‡¶Ø‡¶º ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®‡•§ ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶¨‡¶æ ‡¶á‡¶Ç‡¶∞‡ßá‡¶ú‡¶ø ‚Äî ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã‡¶ü‡¶ø‡•§</div>
      <label class="req">‡¶ò‡¶ü‡¶®‡¶æ‡¶∞ ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§</label>
      <textarea id="desc" placeholder="‡¶Ø‡ßá‡¶Æ‡¶®: ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶´‡ßá‡¶∏‡¶¨‡ßÅ‡¶ï ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶π‡ßç‡¶Ø‡¶æ‡¶ï ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶õ‡¶¨‡¶ø ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶¨‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ï‡¶Æ‡ßá‡¶á‡¶≤ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá..."></textarea>
      <label class="req">‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ</label>
      <div class="check-grid" id="plat-grp">
        <label class="check-item"><input type="checkbox" value="Facebook">üìò Facebook</label>
        <label class="check-item"><input type="checkbox" value="WhatsApp">üí¨ WhatsApp</label>
        <label class="check-item"><input type="checkbox" value="Instagram">üì∏ Instagram</label>
        <label class="check-item"><input type="checkbox" value="TikTok">üéµ TikTok</label>
        <label class="check-item"><input type="checkbox" value="Telegram">‚úàÔ∏è Telegram</label>
        <label class="check-item"><input type="checkbox" value="YouTube">‚ñ∂Ô∏è YouTube</label>
        <label class="check-item"><input type="checkbox" value="Phone/SMS">üì± Phone/SMS</label>
        <label class="check-item"><input type="checkbox" value="Other">üåê ‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø</label>
      </div>
      <label class="req">‡¶∏‡¶π‡¶ø‡¶Ç‡¶∏‡¶§‡¶æ‡¶∞ ‡¶ß‡¶∞‡¶®</label>
      <div class="check-grid" id="viol-grp">
        <label class="check-item"><input type="checkbox" value="blackmail">üíÄ ‡¶¨‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ï‡¶Æ‡ßá‡¶á‡¶≤</label>
        <label class="check-item"><input type="checkbox" value="doxing">üóÇ ‡¶°‡¶ï‡ßç‡¶∏‡¶ø‡¶Ç</label>
        <label class="check-item"><input type="checkbox" value="stalking">üëÅ ‡¶∏‡ßç‡¶ü‡¶ï‡¶ø‡¶Ç</label>
        <label class="check-item"><input type="checkbox" value="account_hack">üîì ‡¶π‡ßç‡¶Ø‡¶æ‡¶ï‡¶ø‡¶Ç</label>
        <label class="check-item"><input type="checkbox" value="non_consensual">üö´ ‡¶Ö‡¶∏‡¶Æ‡ßç‡¶Æ‡¶§‡¶ø‡¶Æ‡ßÇ‡¶≤‡¶ï</label>
        <label class="check-item"><input type="checkbox" value="impersonation">üë§ ‡¶õ‡¶¶‡ßç‡¶Æ‡¶¨‡ßá‡¶∂</label>
        <label class="check-item"><input type="checkbox" value="harassment">üí¨ ‡¶π‡¶Ø‡¶º‡¶∞‡¶æ‡¶®‡¶ø</label>
        <label class="check-item"><input type="checkbox" value="threats">‚ö†Ô∏è ‡¶π‡ßÅ‡¶Æ‡¶ï‡¶ø</label>
      </div>
    </div>

    <div class="card">
      <div class="card-title"><div class="step-num">‡ß®</div> ‡¶™‡¶∞‡¶ø‡¶∏‡ßç‡¶•‡¶ø‡¶§‡¶ø‡¶∞ ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£</div>
      <div class="card-sub">‡¶ù‡ßÅ‡¶Å‡¶ï‡¶ø ‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶£‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§</div>
      <label>‡¶ï‡¶§‡¶¶‡¶ø‡¶® ‡¶ß‡¶∞‡ßá ‡¶π‡¶ö‡ßç‡¶õ‡ßá?</label>
      <input type="range" id="dur" min="1" max="365" value="7" oninput="updDur(this)" style="margin-bottom:5px;">
      <div style="display:flex;justify-content:space-between;font-size:.7rem;color:var(--muted);margin-bottom:14px;">
        <span>‡ßß ‡¶¶‡¶ø‡¶®</span><span id="dur-lbl" style="color:var(--teal2);font-family:var(--mono);">‡ß≠ ‡¶¶‡¶ø‡¶®</span><span>‡ßß ‡¶¨‡¶õ‡¶∞</span>
      </div>
      <label>‡¶Ö‡¶™‡¶∞‡¶æ‡¶ß‡ßÄ ‡¶ï‡¶ø ‡¶™‡¶∞‡¶ø‡¶ö‡¶ø‡¶§?</label>
      <div class="radio-row" id="rg-known">
        <label class="radio-opt" onclick="selRad('rg-known',this)"><input name="known" value="yes">‡¶π‡ßç‡¶Ø‡¶æ‡¶Å</label>
        <label class="radio-opt" onclick="selRad('rg-known',this)"><input name="known" value="no">‡¶®‡¶æ</label>
        <label class="radio-opt" onclick="selRad('rg-known',this)"><input name="known" value="maybe">‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶®‡¶á</label>
      </div>
      <label>‡¶∂‡¶æ‡¶∞‡ßÄ‡¶∞‡¶ø‡¶ï ‡¶π‡ßÅ‡¶Æ‡¶ï‡¶ø ‡¶Ü‡¶õ‡ßá?</label>
      <div class="radio-row" id="rg-threat">
        <label class="radio-opt" onclick="selRad('rg-threat',this)"><input name="threat" value="yes">‚ö†Ô∏è ‡¶π‡ßç‡¶Ø‡¶æ‡¶Å</label>
        <label class="radio-opt" onclick="selRad('rg-threat',this)"><input name="threat" value="no">‡¶®‡¶æ</label>
      </div>
      <label>‡¶Ö‡¶™‡¶∞‡¶æ‡¶ß‡ßÄ‡¶∞ ‡¶è‡¶ñ‡¶®‡ßã ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡ßá ‡¶™‡ßç‡¶∞‡¶¨‡ßá‡¶∂‡¶æ‡¶ß‡¶ø‡¶ï‡¶æ‡¶∞ ‡¶Ü‡¶õ‡ßá?</label>
      <div class="radio-row" id="rg-access">
        <label class="radio-opt" onclick="selRad('rg-access',this)"><input name="access" value="yes">‡¶π‡ßç‡¶Ø‡¶æ‡¶Å</label>
        <label class="radio-opt" onclick="selRad('rg-access',this)"><input name="access" value="no">‡¶®‡¶æ</label>
        <label class="radio-opt" onclick="selRad('rg-access',this)"><input name="access" value="unsure">‡¶ú‡¶æ‡¶®‡¶ø ‡¶®‡¶æ</label>
      </div>
    </div>

    <div class="card">
      <div class="card-title"><div class="step-num">‡ß©</div> ‡¶™‡ßç‡¶∞‡¶Æ‡¶æ‡¶£ ‡¶∏‡¶Ç‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶® (‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï)</div>
      <div class="card-sub">‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø ‡¶´‡¶æ‡¶á‡¶≤ SHA-256 ‡¶π‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶ì Blockchain ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶∏ ‡¶™‡¶æ‡¶¨‡ßá ‚Äî ‡¶Æ‡ßÇ‡¶≤ ‡¶´‡¶æ‡¶á‡¶≤ ‡¶ï‡ßã‡¶•‡¶æ‡¶ì ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º ‡¶®‡¶æ‡•§</div>
      <div class="drop-zone" id="drop-zone">
        <input type="file" id="file-in" multiple accept="image/*,video/*,audio/*,.pdf" onchange="addFiles(this.files)">
        <div class="drop-icon">üìé</div>
        <div class="drop-txt">‡¶´‡¶æ‡¶á‡¶≤ ‡¶ü‡ßá‡¶®‡ßá ‡¶Ü‡¶®‡ßÅ‡¶® ‡¶¨‡¶æ ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®</div>
      </div>
      <div class="file-rows" id="file-rows"></div>
    </div>

    <div class="card">
      <div class="card-title"><div class="step-num">‡ß™</div> ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®</div>
      <div class="check-grid" id="need-grp">
        <label class="check-item"><input type="checkbox" value="scared">üò∞ ‡¶≠‡¶Ø‡¶º‡ßá ‡¶Ü‡¶õ‡¶ø</label>
        <label class="check-item"><input type="checkbox" value="immediate_danger">üÜò ‡¶§‡¶æ‡ßé‡¶ï‡ßç‡¶∑‡¶£‡¶ø‡¶ï ‡¶¨‡¶ø‡¶™‡¶¶</label>
        <label class="check-item"><input type="checkbox" value="counseling">üíô ‡¶Æ‡¶æ‡¶®‡¶∏‡¶ø‡¶ï ‡¶∏‡¶π‡¶æ‡¶Ø‡¶º‡¶§‡¶æ</label>
        <label class="check-item"><input type="checkbox" value="legal">‚öñÔ∏è ‡¶Ü‡¶á‡¶®‡¶ø ‡¶∏‡¶π‡¶æ‡¶Ø‡¶º‡¶§‡¶æ</label>
        <label class="check-item"><input type="checkbox" value="technical">üîß ‡¶™‡ßç‡¶∞‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§‡¶ø‡¶ó‡¶§ ‡¶∏‡¶æ‡¶π‡¶æ‡¶Ø‡ßç‡¶Ø</label>
        <label class="check-item"><input type="checkbox" value="safe_now">‚úÖ ‡¶è‡¶ñ‡¶® ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶¶</label>
      </div>
      <label>‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶ú‡¶æ‡¶®‡¶æ‡¶§‡ßá ‡¶ö‡¶æ‡¶á‡¶≤‡ßá (‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï)</label>
      <input type="text" id="extra" placeholder="‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶§‡¶•‡ßç‡¶Ø...">
    </div>

    <div class="priv-box">
      <div class="priv-icon">üîí</div>
      <div><strong>‡¶ó‡ßã‡¶™‡¶®‡ßÄ‡¶Ø‡¶º‡¶§‡¶æ‡¶∞ ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶Ø‡¶º‡¶§‡¶æ:</strong> ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶ö‡¶Ø‡¶º ‡¶ï‡¶ñ‡¶®‡ßã ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§ ‡¶π‡¶Ø‡¶º ‡¶®‡¶æ‡•§ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü‡¶ü‡¶ø ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶è‡¶®‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü‡ßá‡¶° Case ID-‡¶§‡ßá ‡¶∏‡ßá‡¶≠ ‡¶π‡¶Ø‡¶º‡•§ ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ï‡ßã‡¶®‡ßã ‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡¶ø ‡¶¨‡¶æ ‡¶≤‡ßã‡¶ï‡¶æ‡¶≤ ‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡ßá‡¶ú ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶π‡¶Ø‡¶º ‡¶®‡¶æ‡•§ ‡¶™‡ßá‡¶á‡¶ú ‡¶¨‡¶®‡ßç‡¶ß‡ßá ‡¶∏‡¶¨ ‡¶Æ‡ßá‡¶Æ‡ßã‡¶∞‡¶ø ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶Ø‡¶æ‡¶Ø‡¶º‡•§</div>
    </div>

    <div id="live-risk">
      <div class="risk-wrap">
        <div class="risk-top">
          <span class="risk-label-sm">‡¶§‡¶æ‡ßé‡¶ï‡ßç‡¶∑‡¶£‡¶ø‡¶ï ‡¶ù‡ßÅ‡¶Å‡¶ï‡¶ø ‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø‡¶æ‡¶Ø‡¶º‡¶® (AI)</span>
          <span id="rl-badge" class="rl-low">‡¶®‡¶ø‡¶Æ‡ßç‡¶®</span>
        </div>
        <div class="rbar"><div class="rbar-fill" id="rbar" style="width:5%;background:var(--teal2);"></div></div>
        <div class="risk-note" id="risk-note-txt"></div>
      </div>
    </div>

    <button class="submit-btn" id="sub-btn" onclick="submitReport()">
      üõ° ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶¶‡ßá ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶® ‚Äî AI ‡¶¨‡¶ø‡¶∂‡ßç‡¶≤‡ßá‡¶∑‡¶£ ‡¶∏‡¶π
    </button>
  </div>

  <!-- TAB: AI CHAT -->
  <div id="tab-ai" style="display:none;">
    <div class="card">
      <div class="card-title">ü§ñ AI ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶§‡ßç‡¶§‡¶æ ‡¶∏‡¶π‡¶æ‡¶Ø‡¶º‡¶§‡¶æ</div>
      <div class="card-sub">‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶ó‡ßã‡¶™‡¶®‡ßÄ‡¶Ø‡¶º‡•§ ‡¶ï‡¶•‡ßã‡¶™‡¶ï‡¶•‡¶® ‡¶ï‡ßã‡¶•‡¶æ‡¶ì ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶π‡¶Ø‡¶º ‡¶®‡¶æ‡•§</div>
      <div class="chat-box" id="chat-box">
        <div class="msg msg-ai">
          <div class="msg-ai-icon">ü§ñ</div>
          <div class="msg-ai-bubble">‡¶Ü‡¶∏‡¶æ‡¶≤‡¶æ‡¶Æ‡ßÅ‡¶Ø‡¶º‡¶æ‡¶≤‡¶æ‡¶á‡¶ï‡ßÅ‡¶Æ‡•§ ‡¶Ü‡¶Æ‡¶ø ‡¶∏‡ßÅ‡¶∞‡¶ï‡ßç‡¶∑‡¶æ AI ‡¶∏‡¶π‡¶æ‡¶Ø‡¶º‡¶§‡¶æ‡•§ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶Ü‡¶Æ‡¶æ‡¶ï‡ßá ‡¶¨‡¶≤‡ßÅ‡¶®‡•§</div>
        </div>
      </div>
      <div class="chat-input-row">
        <input type="text" id="chat-in" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶¨‡¶æ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®..." onkeydown="if(event.key==='Enter')sendChat()">
        <button class="chat-send" id="chat-btn" onclick="sendChat()">‡¶™‡¶æ‡¶†‡¶æ‡¶® ‚û§</button>
      </div>
    </div>
  </div>

  <!-- TAB: TRACK -->
  <div id="tab-track" style="display:none;">
    <div class="card">
      <div class="card-title">üîç ‡¶ï‡ßá‡¶∏‡ßá‡¶∞ ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</div>
      <div class="card-sub">‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶™‡¶∞ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ Case ID ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ö‡¶ó‡ßç‡¶∞‡¶ó‡¶§‡¶ø ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®‡•§</div>
      <label>Case ID</label>
      <div style="display:flex;gap:8px;">
        <input type="text" id="track-in" placeholder="‡¶Ø‡ßá‡¶Æ‡¶®: SRK-A1B2C3D4" style="margin-bottom:0;flex:1;">
        <button onclick="trackCase()" style="background:var(--teal);border:none;border-radius:9px;padding:0 18px;color:#fff;font-family:var(--sans);font-size:.88rem;cursor:pointer;font-weight:600;white-space:nowrap;">‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</button>
      </div>
      <div class="track-result" id="track-res"></div>
    </div>
  </div>

  <!-- RESULT PANEL -->
  <div id="result">
    <div class="result-top">
      <div style="font-size:2.2rem;margin-bottom:6px;position:relative;z-index:1;">‚úÖ</div>
      <div style="font-size:1rem;font-weight:700;position:relative;z-index:1;">‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶ú‡¶Æ‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá</div>
      <div style="font-size:.78rem;color:var(--muted);margin-top:4px;position:relative;z-index:1;">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ó‡ßã‡¶™‡¶® Case ID:</div>
      <div class="caseid-box" id="res-caseid">SRK-XXXXXXXX <button class="copy-btn" onclick="copyId()">‡¶ï‡¶™‡¶ø</button></div>
      <div class="result-note">‡¶è‡¶á ID ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶® ‚Äî ‡¶™‡¶∞‡ßá ‡¶ï‡ßá‡¶∏‡ßá‡¶∞ ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ ‡¶ú‡¶æ‡¶®‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá‡¶®</div>
      <div id="db-save-status" class="db-status" style="display:none;">üíæ ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶¶‡ßá ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá</div>
    </div>

    <div class="result-grid">
      <div class="rblock">
        <div class="rblock-title">‚ö†Ô∏è ‡¶ù‡ßÅ‡¶Å‡¶ï‡¶ø ‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®</div>
        <div style="display:flex;align-items:center;gap:10px;margin-bottom:10px;">
          <span id="res-risk-badge">‚Äî</span>
          <span id="res-score" style="font-family:var(--mono);font-size:.75rem;color:var(--muted);"></span>
        </div>
        <div id="res-factors" style="font-size:.8rem;color:var(--text2);line-height:1.7;"></div>
        <div id="res-ai-analysis"></div>
      </div>

      <div class="rblock">
        <div class="rblock-title">‚ö° ‡¶è‡¶ñ‡¶®‡¶á ‡¶Ø‡¶æ ‡¶ï‡¶∞‡¶¨‡ßá‡¶®</div>
        <div id="res-actions"></div>
      </div>

      <!-- THREAT RESOLUTION SECTION (new) -->
      <div class="rblock" id="res-threat-sol-block">
        <div class="rblock-title">üõ† ‡¶π‡ßÅ‡¶Æ‡¶ï‡¶ø ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ ‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶®‡ßá‡¶∞ ‡¶™‡¶¶‡¶ï‡ßç‡¶∑‡ßá‡¶™</div>
        <div class="card-sub" style="margin-bottom:12px;">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø ‡¶ß‡¶∞‡¶®‡ßá‡¶∞ ‡¶π‡ßÅ‡¶Æ‡¶ï‡¶ø‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡¶ø‡¶∑‡ßç‡¶ü ‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶®:</div>
        <div class="threat-sol-section" id="res-threat-solutions"></div>
      </div>

      <div class="rblock">
        <div class="rblock-title">üîê ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶§‡ßç‡¶§‡¶æ ‡¶™‡¶¶‡¶ï‡ßç‡¶∑‡ßá‡¶™</div>
        <div id="res-safety"></div>
      </div>

      <div class="rblock">
        <div class="rblock-title">üìû ‡¶∏‡¶π‡¶æ‡¶Ø‡¶º‡¶§‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</div>
        <div id="res-refs"></div>
      </div>

      <div class="rblock" id="res-ev-block" style="display:none;">
        <div class="rblock-title">üîó ‡¶™‡ßç‡¶∞‡¶Æ‡¶æ‡¶£‡ßá‡¶∞ ‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤ ‡¶∞‡ßá‡¶ï‡¶∞‡ßç‡¶° (Blockchain)</div>
        <div style="font-size:.75rem;color:var(--muted);margin-bottom:8px;">‡¶è‡¶á ‡¶π‡ßç‡¶Ø‡¶æ‡¶∂‡¶ó‡ßÅ‡¶≤‡ßã ‡¶Ü‡¶¶‡¶æ‡¶≤‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶Ø‡ßã‡¶ó‡ßç‡¶Ø ‡¶™‡ßç‡¶∞‡¶Æ‡¶æ‡¶£ ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡¶ó‡¶£‡ßç‡¶Ø ‡¶π‡¶Ø‡¶º‡•§</div>
        <div id="res-hashes"></div>
      </div>
    </div>

    <button onclick="newReport()" style="width:100%;margin-top:16px;background:var(--surface);border:1px solid var(--border);border-radius:11px;padding:13px;font-family:var(--sans);font-size:.88rem;color:var(--muted);cursor:pointer;transition:all .2s;" onmouseover="this.style.borderColor='var(--teal)'" onmouseout="this.style.borderColor='var(--border)'">Ôºã ‡¶®‡¶§‡ßÅ‡¶® ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü</button>
  </div>

  <div style="height:90px;"></div>
</main>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  SURAKSHA v3 ‚Äî Secure User Portal
//  NO localStorage ¬∑ NO sessionStorage ¬∑ NO browser history
//  Reports saved to encrypted DB via persistent storage API
//  Source protected ‚Äî do not distribute
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

(function() {
// Prevent right-click & devtools shortcut on production
document.addEventListener('contextmenu', e => e.preventDefault());
document.addEventListener('keydown', e => {
  if((e.ctrlKey||e.metaKey) && (e.key==='u'||e.key==='U'||e.key==='s'||e.key==='S')) e.preventDefault();
  if(e.key==='F12') e.preventDefault();
  if(e.ctrlKey && e.shiftKey && (e.key==='I'||e.key==='J'||e.key==='C')) e.preventDefault();
});

// ‚îÄ‚îÄ‚îÄ SECURITY: Prevent history API usage ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
history.pushState = () => {};
history.replaceState = () => {};

// ‚îÄ‚îÄ‚îÄ IN-MEMORY ONLY (nothing persisted to browser) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const MEM = { cases: {}, chatHistory: [], lastActive: Date.now() };
let uploadedFiles = [];
let inactivityTimer = null;
let countdownInterval = null;
let timerInterval = null;
const TIMEOUT_MS = 10 * 60 * 1000;
const WARN_MS    = 9.5 * 60 * 1000;

// ‚îÄ‚îÄ‚îÄ PANIC EXIT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let escCount = 0, escTimer = null;
document.addEventListener('keydown', e => {
  if(e.key === 'Escape') {
    escCount++;
    clearTimeout(escTimer);
    escTimer = setTimeout(() => escCount = 0, 1500);
    if(escCount >= 3) PANIC();
  }
  resetActivity();
});

function PANIC() {
  document.title = '‡¶Ü‡¶¨‡¶π‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶æ‡¶≠‡¶æ‡¶∏ ‚Äî ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂';
  document.getElementById('disguise').style.display = 'block';
  document.getElementById('header').style.display = 'none';
  document.getElementById('panic-btn').style.display = 'none';
  MEM.cases = {}; MEM.chatHistory = []; uploadedFiles = [];
  setTimeout(() => { window.location.href = 'https://www.somewhereinblog.net'; }, 4000);
}

document.getElementById('disguise').addEventListener('dblclick', () => {
  document.getElementById('disguise').style.display = 'none';
  document.getElementById('header').style.display = 'flex';
  document.getElementById('panic-btn').style.display = 'flex';
});

// ‚îÄ‚îÄ‚îÄ AUTO-CLEAR (INACTIVITY) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function resetActivity() {
  MEM.lastActive = Date.now();
  document.getElementById('inactivity-warn').style.display = 'none';
  clearInterval(countdownInterval);
  clearTimeout(inactivityTimer);
  inactivityTimer = setTimeout(showInactivityWarning, WARN_MS);
}

function showInactivityWarning() {
  document.getElementById('inactivity-warn').style.display = 'block';
  let sec = 30;
  document.getElementById('warn-sec').textContent = sec;
  countdownInterval = setInterval(() => {
    sec--;
    document.getElementById('warn-sec').textContent = sec;
    if(sec <= 0) { clearInterval(countdownInterval); autoClear(); }
  }, 1000);
}

function autoClear() {
  MEM.cases = {}; MEM.chatHistory = []; uploadedFiles = [];
  document.getElementById('inactivity-warn').style.display = 'none';
  PANIC();
}

timerInterval = setInterval(() => {
  const elapsed = Date.now() - MEM.lastActive;
  const pct = Math.max(0, 100 - (elapsed / TIMEOUT_MS) * 100);
  document.getElementById('timer-fill').style.width = pct + '%';
}, 1000);

['mousemove','keydown','click','touchstart'].forEach(ev =>
  document.addEventListener(ev, resetActivity, { passive: true })
);
resetActivity();

// ‚îÄ‚îÄ‚îÄ TABS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function switchTab(name) {
  ['report','ai','track'].forEach(t => {
    document.getElementById('tab-'+t).style.display = t===name ? 'block' : 'none';
  });
  document.querySelectorAll('.tab').forEach((el, i) => {
    el.classList.toggle('active', ['report','ai','track'][i] === name);
  });
  document.getElementById('result').style.display = 'none';
}
window.switchTab = switchTab;

// ‚îÄ‚îÄ‚îÄ CHECKBOXES & RADIOS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
document.querySelectorAll('.check-grid').forEach(g => {
  g.addEventListener('change', () => {
    g.querySelectorAll('.check-item').forEach(el =>
      el.classList.toggle('on', el.querySelector('input').checked)
    );
    updateRisk();
  });
});

function selRad(gid, el) {
  document.querySelectorAll('#'+gid+' .radio-opt').forEach(r => r.classList.remove('on'));
  el.classList.add('on');
  updateRisk();
}
window.selRad = selRad;

function updDur(el) {
  const v = parseInt(el.value);
  const pct = ((v-1)/364)*100;
  el.style.background = `linear-gradient(to right,var(--teal2) 0%,var(--teal2) ${pct}%,var(--border) ${pct}%)`;
  document.getElementById('dur-lbl').textContent = v === 1 ? '‡ßß ‡¶¶‡¶ø‡¶®' : v + ' ‡¶¶‡¶ø‡¶®';
  updateRisk();
}
window.updDur = updDur;

// ‚îÄ‚îÄ‚îÄ FILE UPLOAD ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function sha256(str) {
  const buf = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(str));
  return Array.from(new Uint8Array(buf)).map(b => b.toString(16).padStart(2,'0')).join('');
}

async function addFiles(files) {
  for(const f of files) {
    if(uploadedFiles.find(x => x.name === f.name)) continue;
    const raw = f.name + f.size + f.lastModified + Math.random();
    const hash = await sha256(raw);
    uploadedFiles.push({ name: f.name, type: f.type, size: f.size, hash, blockRef: '0x'+hash.slice(0,40) });
  }
  renderFiles();
}
window.addFiles = addFiles;

function renderFiles() {
  document.getElementById('file-rows').innerHTML = uploadedFiles.map((f,i) => `
    <div class="file-row">
      <span>${f.type.startsWith('image')?'üñº':f.type.startsWith('video')?'üé•':f.type.startsWith('audio')?'üéµ':'üìÑ'}</span>
      <div><div style="font-size:.79rem;">${f.name}</div><div class="file-hash">SHA-256: ${f.hash.slice(0,28)}...</div></div>
      <span class="rm-file" onclick="rmFile(${i})">‚úï</span>
    </div>`).join('');
}

function rmFile(i) { uploadedFiles.splice(i,1); renderFiles(); }
window.rmFile = rmFile;

const dz = document.getElementById('drop-zone');
dz.addEventListener('dragover', e => { e.preventDefault(); dz.classList.add('over'); });
dz.addEventListener('dragleave', () => dz.classList.remove('over'));
dz.addEventListener('drop', e => { e.preventDefault(); dz.classList.remove('over'); addFiles(e.dataTransfer.files); });

// ‚îÄ‚îÄ‚îÄ RISK ENGINE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const WEIGHTS = { blackmail:.34, non_consensual:.32, threats:.29, account_hack:.23, doxing:.21, stalking:.19, impersonation:.16, harassment:.12 };

function computeScore() {
  let s = 0;
  document.querySelectorAll('#viol-grp input:checked').forEach(cb => s += WEIGHTS[cb.value]||.10);
  if(document.querySelector('[name=threat]:checked')?.value === 'yes') s += .27;
  if(document.querySelector('[name=access]:checked')?.value === 'yes') s += .17;
  if(document.querySelector('[name=access]:checked')?.value === 'unsure') s += .07;
  if(document.querySelector('[name=known]:checked')?.value === 'yes') s += .09;
  const d = parseInt(document.getElementById('dur').value)||7;
  if(d > 30) s += .13; else if(d > 7) s += .06;
  if(document.querySelector('[value=immediate_danger]')?.checked) s += .24;
  if(uploadedFiles.length > 0) s += .03;
  return Math.min(s, 1.0);
}

function getRisk(score) {
  if(score >= .85) return {level:'CRITICAL', label:'‡¶ú‡¶∞‡ßÅ‡¶∞‡¶ø', cls:'rl-critical', color:'#ef4444'};
  if(score >= .60) return {level:'HIGH',     label:'‡¶â‡¶ö‡ßç‡¶ö ‡¶ù‡ßÅ‡¶Å‡¶ï‡¶ø', cls:'rl-high', color:'#f87171'};
  if(score >= .35) return {level:'MEDIUM',   label:'‡¶Æ‡¶æ‡¶ù‡¶æ‡¶∞‡¶ø', cls:'rl-medium', color:'#fbbf24'};
  return                  {level:'LOW',      label:'‡¶®‡¶ø‡¶Æ‡ßç‡¶®', cls:'rl-low', color:'#6ee7b7'};
}

function updateRisk() {
  const desc = document.getElementById('desc').value;
  const vc = document.querySelectorAll('#viol-grp input:checked').length;
  if(!desc && !vc) { document.getElementById('live-risk').style.display='none'; return; }
  document.getElementById('live-risk').style.display = 'block';
  const score = computeScore();
  const risk = getRisk(score);
  const pct = Math.round(score * 100);
  const fill = document.getElementById('rbar');
  fill.style.width = pct + '%';
  fill.style.background = risk.color;
  const badge = document.getElementById('rl-badge');
  badge.className = risk.cls; badge.textContent = risk.label;
  document.getElementById('risk-note-txt').textContent =
    `‡¶∏‡ßç‡¶ï‡ßã‡¶∞: ${pct}% ¬∑ ${risk.level==='CRITICAL'?'üö® ‡¶§‡¶æ‡ßé‡¶ï‡ßç‡¶∑‡¶£‡¶ø‡¶ï ‡¶∏‡¶π‡¶æ‡¶Ø‡¶º‡¶§‡¶æ ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®':risk.level==='HIGH'?'‡¶ú‡¶∞‡ßÅ‡¶∞‡¶ø ‡¶™‡¶¶‡¶ï‡ßç‡¶∑‡ßá‡¶™ ‡¶®‡¶ø‡¶®':risk.level==='MEDIUM'?'‡¶∏‡¶§‡¶∞‡ßç‡¶ï‡¶§‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶è‡¶ó‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ø‡¶æ‡¶®':'‡¶™‡¶∞‡¶ø‡¶∏‡ßç‡¶•‡¶ø‡¶§‡¶ø ‡¶™‡¶∞‡ßç‡¶Ø‡¶¨‡ßá‡¶ï‡ßç‡¶∑‡¶£‡ßá ‡¶∞‡¶æ‡¶ñ‡ßÅ‡¶®'}`;
}

document.getElementById('desc').addEventListener('input', updateRisk);

function genId() {
  const c = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
  let id = 'SRK-';
  for(let i=0;i<8;i++) id += c[Math.floor(Math.random()*c.length)];
  return id;
}

// ‚îÄ‚îÄ‚îÄ THREAT RESOLUTION SOLUTIONS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const THREAT_SOLUTIONS = {
  blackmail: {
    icon: 'üíÄ',
    title: '‡¶¨‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ï‡¶Æ‡ßá‡¶á‡¶≤ / ‡¶∏‡ßá‡¶ï‡ßç‡¶∏‡¶ü‡ßã‡¶∞‡¶∂‡¶® ‡¶•‡ßá‡¶ï‡ßá ‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶®',
    steps: [
      '‡¶è‡¶ñ‡¶®‡¶á ‡¶∏‡¶¨ ‡¶ï‡¶•‡ßã‡¶™‡¶ï‡¶•‡¶® ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶® ‚Äî ‡¶ï‡ßã‡¶®‡ßã ‡¶ú‡¶¨‡¶æ‡¶¨ ‡¶¶‡ßá‡¶¨‡ßá‡¶® ‡¶®‡¶æ, ‡¶ï‡ßã‡¶®‡ßã ‡¶Ö‡¶∞‡ßç‡¶• ‡¶™‡¶æ‡¶†‡¶æ‡¶¨‡ßá‡¶® ‡¶®‡¶æ',
      '‡¶∏‡¶¨ ‡¶π‡ßÅ‡¶Æ‡¶ï‡¶ø‡¶∞ ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡¶∂‡¶ü ‡¶ì ‡¶∏‡¶æ‡¶ï‡ßç‡¶∑‡ßç‡¶Ø ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶® (‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ-‡¶∏‡¶Æ‡¶Ø‡¶º‡¶∏‡¶π)',
      '‡¶∏‡¶Ç‡¶∂‡ßç‡¶≤‡¶ø‡¶∑‡ßç‡¶ü ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ‡ßá ‡¶Ö‡¶™‡¶∞‡¶æ‡¶ß‡ßÄ‡¶ï‡ßá Block ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç Report ‡¶ï‡¶∞‡ßÅ‡¶®',
      '‡¶™‡ßÅ‡¶≤‡¶ø‡¶∂ ‡¶∏‡¶æ‡¶á‡¶¨‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü (PCSW) ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞‡ßá ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®: 01320000888',
      '‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤ ‡¶∏‡¶ø‡¶ï‡¶ø‡¶â‡¶∞‡¶ø‡¶ü‡¶ø ‡¶Ü‡¶á‡¶® ‡ß®‡ß¶‡ßß‡ßÆ-‡¶è‡¶∞ ‡¶ß‡¶æ‡¶∞‡¶æ ‡ß®‡ß¨ ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ ‡¶Æ‡¶æ‡¶Æ‡¶≤‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®',
      '‡¶¨‡¶ø‡¶∂‡ßç‡¶¨‡¶∏‡ßç‡¶§ ‡¶™‡¶∞‡¶ø‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø ‡¶¨‡¶æ ‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶ï‡ßá ‡¶ú‡¶æ‡¶®‡¶æ‡¶® ‚Äî ‡¶Ü‡¶™‡¶®‡¶ø ‡¶è‡¶ï‡¶æ ‡¶®‡¶®',
    ]
  },
  doxing: {
    icon: 'üóÇ',
    title: '‡¶°‡¶ï‡ßç‡¶∏‡¶ø‡¶Ç ‡¶•‡ßá‡¶ï‡ßá ‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶®',
    steps: [
      '‡¶∏‡ßã‡¶∂‡ßç‡¶Ø‡¶æ‡¶≤ ‡¶Æ‡¶ø‡¶°‡¶ø‡¶Ø‡¶º‡¶æ ‡¶•‡ßá‡¶ï‡ßá ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ, ‡¶´‡ßã‡¶®, ‡¶ï‡¶∞‡ßç‡¶Æ‡¶∏‡ßç‡¶•‡¶≤ ‡¶§‡¶•‡ßç‡¶Ø ‡¶Ö‡¶¨‡¶ø‡¶≤‡¶Æ‡ßç‡¶¨‡ßá ‡¶∏‡¶∞‡¶ø‡¶Ø‡¶º‡ßá ‡¶®‡¶ø‡¶®',
      '‡¶∏‡¶¨ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü Private ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç Location Sharing ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶®',
      '‡¶™‡ßç‡¶∞‡¶ö‡¶æ‡¶∞‡¶ø‡¶§ ‡¶§‡¶•‡ßç‡¶Ø ‡¶Ø‡ßá ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ‡ßá ‡¶Ü‡¶õ‡ßá ‡¶∏‡ßá‡¶ñ‡¶æ‡¶®‡ßá Content Removal Request ‡¶¶‡¶ø‡¶®',
      'Google-‡¶è ‡¶¨‡ßç‡¶Ø‡¶ï‡ßç‡¶§‡¶ø‡¶ó‡¶§ ‡¶§‡¶•‡ßç‡¶Ø ‡¶•‡¶æ‡¶ï‡¶≤‡ßá "Remove Results" ‡¶´‡¶∞‡ßç‡¶Æ ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®',
      '‡¶™‡ßÅ‡¶≤‡¶ø‡¶∂‡¶ï‡ßá ‡¶ú‡¶æ‡¶®‡¶æ‡¶® ‚Äî ‡¶∂‡¶æ‡¶∞‡ßÄ‡¶∞‡¶ø‡¶ï ‡¶π‡ßÅ‡¶Æ‡¶ï‡¶ø‡¶∞ ‡¶ù‡ßÅ‡¶Å‡¶ï‡¶ø ‡¶•‡¶æ‡¶ï‡¶≤‡ßá ‡¶•‡¶æ‡¶®‡¶æ‡¶Ø‡¶º GD ‡¶ï‡¶∞‡ßÅ‡¶®',
      '‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç 2FA ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶∏‡¶¨ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡ßá',
    ]
  },
  stalking: {
    icon: 'üëÅ',
    title: '‡¶∏‡ßç‡¶ü‡¶ï‡¶ø‡¶Ç ‡¶•‡ßá‡¶ï‡ßá ‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶®',
    steps: [
      '‡¶∏‡¶¨ ‡¶∏‡ßã‡¶∂‡ßç‡¶Ø‡¶æ‡¶≤ ‡¶Æ‡¶ø‡¶°‡¶ø‡¶Ø‡¶º‡¶æ Private ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶Ö‡¶™‡¶∞‡¶ø‡¶ö‡¶ø‡¶§ Follow Request Reject ‡¶ï‡¶∞‡ßÅ‡¶®',
      'Location Services ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶∏‡¶¨ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßá',
      '‡¶Ö‡¶™‡¶∞‡¶æ‡¶ß‡ßÄ‡¶ï‡ßá ‡¶∏‡¶¨ ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ‡ßá Block ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶®‡¶§‡ßÅ‡¶® Account ‡¶•‡ßá‡¶ï‡ßá ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶è‡¶≤‡ßá‡¶ì Block ‡¶ï‡¶∞‡ßÅ‡¶®',
      '‡¶Ø‡¶æ‡¶§‡¶æ‡¶Ø‡¶º‡¶æ‡¶§‡ßá‡¶∞ ‡¶∞‡ßÅ‡¶ü‡¶ø‡¶® ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®, ‡¶è‡¶ï‡¶æ ‡¶®‡¶æ ‡¶ö‡¶≤‡¶æ‡¶´‡ßá‡¶∞‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®',
      '‡¶ò‡¶ü‡¶®‡¶æ‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ-‡¶∏‡¶Æ‡¶Ø‡¶º-‡¶¨‡¶ø‡¶¨‡¶∞‡¶£ ‡¶≤‡¶ø‡¶ñ‡¶ø‡¶§ ‡¶∞‡¶æ‡¶ñ‡ßÅ‡¶® ‚Äî ‡¶Æ‡¶æ‡¶Æ‡¶≤‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶™‡ßç‡¶∞‡¶Æ‡¶æ‡¶£ ‡¶π‡¶¨‡ßá',
      '‡¶•‡¶æ‡¶®‡¶æ‡¶Ø‡¶º General Diary (GD) ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç PCSW-‡¶§‡ßá ‡¶ú‡¶æ‡¶®‡¶æ‡¶®: 01320000888',
    ]
  },
  account_hack: {
    icon: 'üîì',
    title: '‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶π‡ßç‡¶Ø‡¶æ‡¶ï‡¶ø‡¶Ç ‡¶•‡ßá‡¶ï‡ßá ‡¶™‡ßÅ‡¶®‡¶∞‡ßÅ‡¶¶‡ßç‡¶ß‡¶æ‡¶∞',
    steps: [
      '‡¶è‡¶ñ‡¶®‡¶á ‡¶∏‡¶¨ ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶•‡ßá‡¶ï‡ßá Log Out ‡¶ï‡¶∞‡ßÅ‡¶® (Settings ‚Üí Active Sessions)',
      '‡¶¨‡¶ø‡¶∂‡ßç‡¶¨‡¶∏‡ßç‡¶§ ‡¶®‡¶ø‡¶ú‡ßá‡¶∞ ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶•‡ßá‡¶ï‡ßá ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡ßÅ‡¶® ‚Äî ‡¶∂‡¶ï‡ßç‡¶§‡¶ø‡¶∂‡¶æ‡¶≤‡ßÄ ‡¶ì ‡¶Ö‡¶®‡¶®‡ßç‡¶Ø',
      'Two-Factor Authentication (2FA) ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶® ‚Äî Authenticator App ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®',
      'Recovery Email ‡¶ì Phone Number ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶§‡ßç‡¶§‡¶æ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®',
      'Account Recovery Form ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶® (Facebook/Google ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü‡ßá)',
      '‡¶π‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶ï‡ßã‡¶®‡ßã ‡¶¨‡¶æ‡¶∞‡ßç‡¶§‡¶æ ‡¶™‡¶æ‡¶†‡¶ø‡¶Ø‡¶º‡ßá ‡¶•‡¶æ‡¶ï‡¶≤‡ßá ‡¶™‡¶∞‡¶ø‡¶ö‡¶ø‡¶§‡¶¶‡ßá‡¶∞ ‡¶∏‡¶§‡¶∞‡ßç‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®',
    ]
  },
  non_consensual: {
    icon: 'üö´',
    title: '‡¶Ö‡¶∏‡¶Æ‡ßç‡¶Æ‡¶§‡¶ø‡¶Æ‡ßÇ‡¶≤‡¶ï ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶•‡ßá‡¶ï‡ßá ‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶®',
    steps: [
      '‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü‡¶ü‡¶ø ‡¶Ø‡ßá ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ‡ßá ‡¶Ü‡¶õ‡ßá ‡¶∏‡ßá‡¶ñ‡¶æ‡¶®‡ßá "Report" ‡¶¨‡¶æ "Flag" ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶Ö‡¶¨‡¶ø‡¶≤‡¶Æ‡ßç‡¶¨‡ßá',
      'Meta/Google/TikTok-‡¶è‡¶∞ Non-Consensual Intimate Image Removal Tool ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®',
      'StopNCII.org-‡¶è Hash ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶® ‚Äî ‡¶è‡¶ü‡¶ø ‡¶õ‡¶¨‡¶ø‡¶∞ ‡¶∏‡¶§‡ßç‡¶Ø‡¶ø‡¶ï‡¶æ‡¶∞ ‡¶ï‡¶™‡¶ø ‡¶õ‡¶æ‡¶°‡¶º‡¶æ‡¶á ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∞‡ßã‡¶ß ‡¶ï‡¶∞‡ßá',
      '‡¶∏‡¶æ‡¶ï‡ßç‡¶∑‡ßç‡¶Ø ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá URL ‡¶ì ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡¶∂‡¶ü ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶® (‡¶®‡¶ø‡¶ú‡ßá ‡¶∂‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶¨‡ßá‡¶® ‡¶®‡¶æ)',
      '‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤ ‡¶∏‡¶ø‡¶ï‡¶ø‡¶â‡¶∞‡¶ø‡¶ü‡¶ø ‡¶Ü‡¶á‡¶® ‡ß®‡ß¶‡ßß‡ßÆ-‡¶è‡¶∞ ‡¶ß‡¶æ‡¶∞‡¶æ ‡ß®‡ß¨-‡¶è ‡¶Æ‡¶æ‡¶Æ‡¶≤‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®',
      '‡¶Æ‡¶æ‡¶®‡¶∏‡¶ø‡¶ï ‡¶∏‡ßç‡¶¨‡¶æ‡¶∏‡ßç‡¶•‡ßç‡¶Ø ‡¶π‡ßá‡¶≤‡ßç‡¶™‡¶≤‡¶æ‡¶á‡¶®‡ßá ‡¶ï‡¶•‡¶æ ‡¶¨‡¶≤‡ßÅ‡¶®: 01779-554391',
    ]
  },
  impersonation: {
    icon: 'üë§',
    title: '‡¶õ‡¶¶‡ßç‡¶Æ‡¶¨‡ßá‡¶∂ / Impersonation ‡¶•‡ßá‡¶ï‡ßá ‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶®',
    steps: [
      '‡¶≠‡ßÅ‡¶Ø‡¶º‡¶æ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶ü‡¶ø Report ‡¶ï‡¶∞‡ßÅ‡¶® "Pretending to be me" ‡¶¨‡¶ø‡¶ï‡¶≤‡ßç‡¶™ ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá',
      '‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ‡ßá ‡¶≠‡ßÅ‡¶Ø‡¶º‡¶æ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤‡ßá‡¶∞ Report ‡¶ï‡¶∞‡ßÅ‡¶® ‚Äî ‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶¶‡ßá‡¶∞‡¶ì ‡¶ï‡¶∞‡¶§‡ßá ‡¶¨‡¶≤‡ßÅ‡¶®',
      '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶ö‡¶ø‡¶§‡¶¶‡ßá‡¶∞ ‡¶∏‡¶§‡¶∞‡ßç‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶Ø‡ßá ‡¶≠‡ßÅ‡¶Ø‡¶º‡¶æ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶ö‡¶≤‡¶õ‡ßá',
      '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶∏‡¶≤ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤‡ßá Verified/Blue Tick-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶¨‡ßá‡¶¶‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®',
      '‡¶≠‡ßÅ‡¶Ø‡¶º‡¶æ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡ßá‡¶∞ ‡¶∏‡¶¨ ‡¶™‡ßã‡¶∏‡ßç‡¶ü ‡¶ì ‡¶ï‡¶æ‡¶∞‡ßç‡¶Ø‡¶ï‡¶≤‡¶æ‡¶™‡ßá‡¶∞ ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡¶∂‡¶ü ‡¶∞‡¶æ‡¶ñ‡ßÅ‡¶®',
      '‡¶™‡ßÅ‡¶≤‡¶ø‡¶∂ ‡¶∏‡¶æ‡¶á‡¶¨‡¶æ‡¶∞ ‡¶á‡¶â‡¶®‡¶ø‡¶ü‡ßá ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®: 01320000888',
    ]
  },
  harassment: {
    icon: 'üí¨',
    title: '‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶® ‡¶π‡¶Ø‡¶º‡¶∞‡¶æ‡¶®‡¶ø ‡¶•‡ßá‡¶ï‡ßá ‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶®',
    steps: [
      '‡¶π‡¶Ø‡¶º‡¶∞‡¶æ‡¶®‡¶ø‡¶ï‡¶æ‡¶∞‡ßÄ‡¶ï‡ßá Block ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶∏‡¶¨ ‡¶™‡ßç‡¶∞‡¶Æ‡¶æ‡¶£ ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®',
      '‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ‡ßá Report ‡¶ï‡¶∞‡ßÅ‡¶® ‚Äî Comments/Messages-‡¶è "Report" ‡¶Ö‡¶™‡¶∂‡¶® ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®',
      'Keyword Filter ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶® ‚Äî ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡¶ø‡¶∑‡ßç‡¶ü ‡¶∂‡¶¨‡ßç‡¶¶ ‡¶•‡ßá‡¶ï‡ßá ‡¶Æ‡¶®‡ßç‡¶§‡¶¨‡ßç‡¶Ø ‡¶≤‡ßÅ‡¶ï‡¶æ‡¶®',
      'Mute/Restrict ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶® ‚Äî Block ‡¶®‡¶æ ‡¶ï‡¶∞‡¶≤‡ßá‡¶ì ‡¶π‡¶Ø‡¶º‡¶∞‡¶æ‡¶®‡¶ø‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶¨‡ßÅ‡¶ù‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá ‡¶®‡¶æ',
      '‡¶ï‡ßç‡¶∞‡¶Æ‡¶æ‡¶ó‡¶§ ‡¶π‡¶≤‡ßá Screen Time ‡¶ï‡¶Æ‡¶æ‡¶® ‡¶è‡¶¨‡¶Ç Mental Health Support ‡¶®‡¶ø‡¶®',
      '‡¶¨‡¶æ‡¶∞‡¶¨‡¶æ‡¶∞ ‡¶π‡¶≤‡ßá ‡¶•‡¶æ‡¶®‡¶æ‡¶Ø‡¶º GD ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç PCSW-‡¶§‡ßá ‡¶ú‡¶æ‡¶®‡¶æ‡¶®',
    ]
  },
  threats: {
    icon: '‚ö†Ô∏è',
    title: '‡¶∂‡¶æ‡¶∞‡ßÄ‡¶∞‡¶ø‡¶ï ‡¶π‡ßÅ‡¶Æ‡¶ï‡¶ø / ‡¶Æ‡ßÉ‡¶§‡ßç‡¶Ø‡ßÅ‡¶≠‡¶Ø‡¶º ‡¶•‡ßá‡¶ï‡ßá ‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶®',
    steps: [
      '‡¶è‡¶ñ‡¶®‡¶á ‡ßØ‡ßØ‡ßØ-‡¶è ‡¶´‡ßã‡¶® ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶Ø‡¶¶‡¶ø ‡¶§‡¶æ‡ßé‡¶ï‡ßç‡¶∑‡¶£‡¶ø‡¶ï ‡¶¨‡¶ø‡¶™‡¶¶ ‡¶•‡¶æ‡¶ï‡ßá',
      '‡¶∏‡¶¨ ‡¶π‡ßÅ‡¶Æ‡¶ï‡¶ø‡¶∞ ‡¶¨‡¶æ‡¶∞‡ßç‡¶§‡¶æ ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡¶∂‡¶ü ‡¶ì ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®',
      '‡¶¨‡¶ø‡¶∂‡ßç‡¶¨‡¶∏‡ßç‡¶§ ‡¶Æ‡¶æ‡¶®‡ßÅ‡¶∑‡¶ï‡ßá ‡¶ú‡¶æ‡¶®‡¶æ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶¶ ‡¶∏‡ßç‡¶•‡¶æ‡¶®‡ßá ‡¶Ø‡¶æ‡¶®',
      '‡¶•‡¶æ‡¶®‡¶æ‡¶Ø‡¶º GD ‡¶ï‡¶∞‡ßÅ‡¶® ‚Äî ‡¶∂‡¶æ‡¶∞‡ßÄ‡¶∞‡¶ø‡¶ï ‡¶π‡ßÅ‡¶Æ‡¶ï‡¶ø ‡¶´‡ßå‡¶ú‡¶¶‡¶æ‡¶∞‡¶ø ‡¶Ö‡¶™‡¶∞‡¶æ‡¶ß',
      '‡¶Ö‡¶™‡¶∞‡¶æ‡¶ß‡ßÄ ‡¶Ø‡¶¶‡¶ø ‡¶™‡¶∞‡¶ø‡¶ö‡¶ø‡¶§ ‡¶π‡¶Ø‡¶º ‚Äî Restraining Order-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶¶‡¶æ‡¶≤‡¶§‡ßá ‡¶Ø‡¶æ‡¶®',
      'PCSW-‡¶§‡ßá ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®: 01320000888',
    ]
  },
};

function buildThreatSolutions(vTypes) {
  if(!vTypes.length) return '';
  return vTypes.map(vt => {
    const sol = THREAT_SOLUTIONS[vt];
    if(!sol) return '';
    const steps = sol.steps.map((s,i) => `
      <li><div class="sol-num">${i+1}</div><div>${s}</div></li>`).join('');
    return `
      <div class="threat-sol-card">
        <div class="threat-sol-hdr">
          <span class="threat-sol-icon">${sol.icon}</span>
          <span class="threat-sol-title">${sol.title}</span>
        </div>
        <ul class="threat-sol-steps">${steps}</ul>
      </div>`;
  }).join('');
}

// ‚îÄ‚îÄ‚îÄ IMMEDIATE ACTIONS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function getActions(score, vTypes, threat, access) {
  const acts = [];
  if(score >= .85 || threat === 'yes') {
    acts.push('üö® ‡¶è‡¶ñ‡¶®‡¶á ‡¶™‡ßÅ‡¶≤‡¶ø‡¶∂ ‡¶∏‡¶æ‡¶á‡¶¨‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü‡ßá ‡¶´‡ßã‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®: 01320000888');
    acts.push('‡¶¨‡¶ø‡¶∂‡ßç‡¶¨‡¶∏‡ßç‡¶§ ‡¶ï‡¶æ‡¶â‡¶ï‡ßá ‡¶è‡¶á ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§‡ßá ‡¶ú‡¶æ‡¶®‡¶æ‡¶® ‡¶ì ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶¶ ‡¶∏‡ßç‡¶•‡¶æ‡¶®‡ßá ‡¶Ø‡¶æ‡¶®');
  }
  if(access === 'yes' || vTypes.includes('account_hack')) {
    acts.push('‡¶∏‡¶¨ ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶•‡ßá‡¶ï‡ßá ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶ñ‡¶®‡¶á');
    acts.push('‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶ø‡¶ú‡ßá‡¶∞ ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶•‡ßá‡¶ï‡ßá ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®');
  }
  if(vTypes.includes('blackmail') || vTypes.includes('non_consensual')) {
    acts.push('‡¶π‡ßÅ‡¶Æ‡¶ï‡¶ø‡¶∞ ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡¶∂‡¶ü ‡¶®‡¶ø‡¶® ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶ï‡ßã‡¶®‡ßã ‡¶ú‡¶¨‡¶æ‡¶¨ ‡¶¶‡ßá‡¶¨‡ßá‡¶® ‡¶®‡¶æ');
    acts.push('‡¶Ö‡¶™‡¶∞‡¶æ‡¶ß‡ßÄ‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶®');
  }
  acts.push('Two-Factor Authentication (2FA) ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶∏‡¶¨ ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡ßá');
  if(vTypes.includes('doxing')) acts.push('‡¶∏‡ßã‡¶∂‡ßç‡¶Ø‡¶æ‡¶≤ ‡¶Æ‡¶ø‡¶°‡¶ø‡¶Ø‡¶º‡¶æ ‡¶•‡ßá‡¶ï‡ßá ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ ‡¶ì ‡¶´‡ßã‡¶® ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶∏‡¶∞‡¶æ‡¶®');
  return acts.slice(0, 6);
}

// ‚îÄ‚îÄ‚îÄ SAFETY GUIDES ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const GUIDES = {
  'Facebook': ['Settings ‚Üí Security ‚Üí Where You\'re Logged In ‚Üí ‡¶∏‡¶¨ ‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü','Settings ‚Üí Security ‚Üí Two-Factor Authentication ‚Üí ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®','Settings ‚Üí Privacy ‚Üí Who can find me ‚Üí Friends only','‡¶Ö‡¶™‡¶∞‡¶æ‡¶ß‡ßÄ‡¶ï‡ßá Block ‡¶ì Profile Report ‡¶ï‡¶∞‡ßÅ‡¶®'],
  'WhatsApp': ['Settings ‚Üí Account ‚Üí Two-step verification ‚Üí ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®','Settings ‚Üí Privacy ‚Üí Profile photo ‚Üí My contacts only','Linked Devices ‚Üí ‡¶∏‡¶¨ ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶∏‡¶∞‡¶ø‡¶Ø‡¶º‡ßá ‡¶¶‡¶ø‡¶®','‡¶Ö‡¶™‡¶∞‡¶æ‡¶ß‡ßÄ‡¶∞ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ Block ‡¶ï‡¶∞‡ßÅ‡¶®'],
  'Instagram': ['Settings ‚Üí Security ‚Üí Two-Factor Authentication ‚Üí ‡¶ö‡¶æ‡¶≤‡ßÅ','Settings ‚Üí Privacy ‚Üí Private Account ‚Üí ‡¶ö‡¶æ‡¶≤‡ßÅ','Settings ‚Üí Security ‚Üí Login Activity ‚Üí ‡¶Ö‡¶™‡¶∞‡¶ø‡¶ö‡¶ø‡¶§ ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶∏‡¶∞‡¶æ‡¶®'],
  'TikTok': ['Settings ‚Üí Security ‚Üí Two-Step Verification ‚Üí ‡¶ö‡¶æ‡¶≤‡ßÅ','Settings ‚Üí Privacy ‚Üí Private Account ‚Üí ‡¶ö‡¶æ‡¶≤‡ßÅ','‡¶Ö‡¶™‡¶∞‡¶æ‡¶ß‡ßÄ‡¶∞ ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü Report ‡¶ï‡¶∞‡ßÅ‡¶®'],
  'default': ['‡¶∏‡¶¨ ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡ßá Unique Password ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®','2FA ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶∏‡¶¨ ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ‡ßá','Location Sharing ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶®','‡¶¨‡ßç‡¶Ø‡¶ï‡ßç‡¶§‡¶ø‡¶ó‡¶§ ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶•‡ßá‡¶ï‡ßá ‡¶∏‡¶∞‡¶æ‡¶®'],
};

function getSafetyGuide(platforms) {
  if(!platforms.length) return [{ pl: '‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£', steps: GUIDES.default }];
  return platforms.map(p => ({ pl: p, steps: (GUIDES[p]||GUIDES.default).slice(0,3) }));
}

// ‚îÄ‚îÄ‚îÄ REFERRALS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const REFS_ALL = [
  { id:'999',   name:'‡¶ú‡¶∞‡ßÅ‡¶∞‡¶ø ‡¶∏‡ßá‡¶¨‡¶æ', num:'999', icon:'üÜò', urgent:true, min:.85 },
  { id:'pcsw',  name:'‡¶™‡ßÅ‡¶≤‡¶ø‡¶∂ ‡¶∏‡¶æ‡¶á‡¶¨‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü (PCSW)', num:'01320000888', icon:'üëÆ', urgent:true, min:.40 },
  { id:'legal', name:'‡¶ú‡¶æ‡¶§‡ßÄ‡¶Ø‡¶º ‡¶Ü‡¶á‡¶®‡¶ø ‡¶∏‡¶π‡¶æ‡¶Ø‡¶º‡¶§‡¶æ', num:'16430 (‡¶¨‡¶ø‡¶®‡¶æ‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø‡ßá)', icon:'‚öñÔ∏è', urgent:false, min:.35 },
  { id:'mental',name:'‡¶Æ‡¶æ‡¶®‡¶∏‡¶ø‡¶ï ‡¶∏‡ßç‡¶¨‡¶æ‡¶∏‡ßç‡¶•‡ßç‡¶Ø ‡¶π‡ßá‡¶≤‡ßç‡¶™‡¶≤‡¶æ‡¶á‡¶®', num:'01779-554391', icon:'üíô', urgent:false, min:0 },
  { id:'bnnrc', name:'BNNRC ‡¶∏‡¶π‡¶æ‡¶Ø‡¶º‡¶§‡¶æ ‡¶ï‡ßá‡¶®‡ßç‡¶¶‡ßç‡¶∞', num:'01726311101', icon:'üè¢', urgent:false, min:0 },
  { id:'safe',  name:'‡¶ú‡¶∞‡ßÅ‡¶∞‡¶ø ‡¶Ü‡¶∂‡ßç‡¶∞‡¶Ø‡¶º ‡¶®‡ßá‡¶ü‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶ï', num:'10921', icon:'üè†', urgent:true, min:.70 },
];

function getRefs(score) { return REFS_ALL.filter(r => score >= r.min); }

function buildFactors(score, vTypes, dur, threat, access) {
  const MAP = { blackmail:'‡¶¨‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ï‡¶Æ‡ßá‡¶á‡¶≤', non_consensual:'‡¶Ö‡¶∏‡¶Æ‡ßç‡¶Æ‡¶§‡¶ø‡¶Æ‡ßÇ‡¶≤‡¶ï ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü', threats:'‡¶π‡ßÅ‡¶Æ‡¶ï‡¶ø', doxing:'‡¶°‡¶ï‡ßç‡¶∏‡¶ø‡¶Ç', account_hack:'‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶π‡ßç‡¶Ø‡¶æ‡¶ï', stalking:'‡¶∏‡ßç‡¶ü‡¶ï‡¶ø‡¶Ç', impersonation:'‡¶õ‡¶¶‡ßç‡¶Æ‡¶¨‡ßá‡¶∂', harassment:'‡¶π‡¶Ø‡¶º‡¶∞‡¶æ‡¶®‡¶ø' };
  const f = vTypes.map(v => '‚Ä¢ ' + (MAP[v]||v));
  if(threat==='yes') f.push('‚Ä¢ ‡¶∂‡¶æ‡¶∞‡ßÄ‡¶∞‡¶ø‡¶ï ‡¶π‡ßÅ‡¶Æ‡¶ï‡¶ø ‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶Æ‡¶æ‡¶®');
  if(access==='yes') f.push('‚Ä¢ ‡¶Ö‡¶™‡¶∞‡¶æ‡¶ß‡ßÄ‡¶∞ ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡ßá ‡¶™‡ßç‡¶∞‡¶¨‡ßá‡¶∂‡¶æ‡¶ß‡¶ø‡¶ï‡¶æ‡¶∞ ‡¶Ü‡¶õ‡ßá');
  if(dur > 30) f.push(`‚Ä¢ ‡¶¶‡ßÄ‡¶∞‡ßç‡¶ò‡¶Æ‡ßá‡¶Ø‡¶º‡¶æ‡¶¶‡ßÄ ‡¶∏‡¶π‡¶ø‡¶Ç‡¶∏‡¶§‡¶æ (${dur} ‡¶¶‡¶ø‡¶®)`);
  if(uploadedFiles.length > 0) f.push(`‚Ä¢ ${uploadedFiles.length}‡¶ü‡¶ø ‡¶™‡ßç‡¶∞‡¶Æ‡¶æ‡¶£ ‡¶∏‡¶Ç‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§`);
  return f;
}

// ‚îÄ‚îÄ‚îÄ ANTHROPIC AI CALL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function callAI(systemPrompt, userMessage, conversationHistory = []) {
  const messages = [...conversationHistory, { role: 'user', content: userMessage }];
  try {
    const resp = await fetch('https://api.anthropic.com/v1/messages', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ model: 'claude-sonnet-4-20250514', max_tokens: 1000, system: systemPrompt, messages })
    });
    const data = await resp.json();
    return data.content?.map(c => c.text || '').join('') || null;
  } catch(e) { return null; }
}

async function analyzeIncident(desc, vTypes, riskLevel) {
  const system = `‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø TFGBV ‡¶∏‡¶π‡¶æ‡¶Ø‡¶º‡¶§‡¶æ AI‡•§ ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡ßá‡¶ï‡ßç‡¶∑‡¶æ‡¶™‡¶ü‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßã‡•§
‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶ú: ‡¶≠‡ßÅ‡¶ï‡ßç‡¶§‡¶≠‡ßã‡¶ó‡ßÄ‡¶∞ ‡¶¨‡¶∞‡ßç‡¶£‡¶®‡¶æ ‡¶™‡¶°‡¶º‡ßá ‡¶∏‡¶Ç‡¶ï‡ßç‡¶∑‡¶ø‡¶™‡ßç‡¶§, ‡¶∏‡ßç‡¶™‡¶∑‡ßç‡¶ü ‡¶ì ‡¶∏‡¶π‡¶æ‡¶®‡ßÅ‡¶≠‡ßÇ‡¶§‡¶ø‡¶∂‡ßÄ‡¶≤ ‡¶™‡¶∞‡¶æ‡¶Æ‡¶∞‡ßç‡¶∂ ‡¶¶‡¶æ‡¶ì‡•§
‡¶®‡¶ø‡¶Ø‡¶º‡¶Æ: ‡¶∏‡¶∞‡ßç‡¶¨‡¶¶‡¶æ ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶Ø‡¶º ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶¶‡¶æ‡¶ì‡•§ ‡ß©-‡ß™‡¶ü‡¶ø ‡¶∏‡ßÅ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡¶ø‡¶∑‡ßç‡¶ü ‡¶™‡¶¶‡¶ï‡ßç‡¶∑‡ßá‡¶™‡•§ ‡¶≠‡ßÅ‡¶ï‡ßç‡¶§‡¶≠‡ßã‡¶ó‡ßÄ‡¶ï‡ßá ‡¶¶‡ßã‡¶∑‡ßÄ ‡¶Æ‡¶®‡ßá ‡¶ï‡¶∞‡¶æ‡¶¨‡ßá ‡¶®‡¶æ‡•§ ‡¶∏‡¶Ç‡¶ï‡ßç‡¶∑‡¶ø‡¶™‡ßç‡¶§ ‡¶∞‡¶æ‡¶ñ‡ßã (‡ß¨ ‡¶≤‡¶æ‡¶á‡¶®‡ßá‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá)‡•§`;
  const prompt = `‡¶ò‡¶ü‡¶®‡¶æ‡¶∞ ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£: "${desc}"\n‡¶∏‡¶π‡¶ø‡¶Ç‡¶∏‡¶§‡¶æ‡¶∞ ‡¶ß‡¶∞‡¶®: ${vTypes.join(', ')}\n‡¶ù‡ßÅ‡¶Å‡¶ï‡¶ø‡¶∞ ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞‡¶æ: ${riskLevel}\n‡¶è‡¶á ‡¶™‡¶∞‡¶ø‡¶∏‡ßç‡¶•‡¶ø‡¶§‡¶ø‡¶§‡ßá ‡¶§‡¶æ‡ßé‡¶ï‡ßç‡¶∑‡¶£‡¶ø‡¶ï ‡¶ï‡ßÄ ‡¶ï‡¶∞‡¶£‡ßÄ‡¶Ø‡¶º?`;
  return await callAI(system, prompt);
}

const AI_CHAT_SYSTEM = `‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶∏‡ßÅ‡¶∞‡¶ï‡ßç‡¶∑‡¶æ AI ‚Äî ‡¶è‡¶ï‡¶ü‡¶ø TFGBV ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∞‡ßã‡¶ß ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ‡ßá‡¶∞ ‡¶∏‡¶π‡¶æ‡¶Ø‡¶º‡¶§‡¶æ‡¶ï‡¶æ‡¶∞‡ßÄ AI‡•§ ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡ßá‡¶ï‡ßç‡¶∑‡¶æ‡¶™‡¶ü‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßã‡•§
‡¶≠‡ßÇ‡¶Æ‡¶ø‡¶ï‡¶æ: ‡¶≠‡ßÅ‡¶ï‡ßç‡¶§‡¶≠‡ßã‡¶ó‡ßÄ‡¶ï‡ßá ‡¶Æ‡¶æ‡¶®‡¶∏‡¶ø‡¶ï ‡¶∏‡¶π‡¶æ‡¶Ø‡¶º‡¶§‡¶æ ‡¶ì ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ø‡¶ï ‡¶™‡¶∞‡¶æ‡¶Æ‡¶∞‡ßç‡¶∂ ‡¶¶‡¶æ‡¶ì‡•§ ‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤ ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶§‡ßç‡¶§‡¶æ ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡ßá‡¶∂‡¶®‡¶æ ‡¶¶‡¶æ‡¶ì‡•§ ‡¶∏‡¶∞‡ßç‡¶¨‡¶¶‡¶æ ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶Ø‡¶º ‡¶ï‡¶•‡¶æ ‡¶¨‡¶≤‡ßã‡•§ ‡¶≠‡ßÅ‡¶ï‡ßç‡¶§‡¶≠‡ßã‡¶ó‡ßÄ‡¶ï‡ßá ‡¶ï‡¶ñ‡¶®‡ßã ‡¶¶‡ßã‡¶∑ ‡¶¶‡ßá‡¶¨‡ßá ‡¶®‡¶æ‡•§
‡¶ú‡¶∞‡ßÅ‡¶∞‡¶ø ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞: PCSW: 01320000888 ¬∑ ‡¶Ü‡¶á‡¶®‡¶ø ‡¶∏‡¶π‡¶æ‡¶Ø‡¶º‡¶§‡¶æ: 16430 ¬∑ ‡¶Æ‡¶æ‡¶®‡¶∏‡¶ø‡¶ï ‡¶∏‡ßç‡¶¨‡¶æ‡¶∏‡ßç‡¶•‡ßç‡¶Ø: 01779-554391 ¬∑ ‡¶ú‡¶∞‡ßÅ‡¶∞‡¶ø: 999`;

async function sendChat() {
  const input = document.getElementById('chat-in');
  const msg = input.value.trim();
  if(!msg) return;
  input.value = '';
  addChatMsg('user', msg);
  MEM.chatHistory.push({ role: 'user', content: msg });
  document.getElementById('chat-btn').disabled = true;
  const typingId = addTyping();
  const aiResp = await callAI(AI_CHAT_SYSTEM, msg, MEM.chatHistory.slice(-6,-1));
  removeTyping(typingId);
  document.getElementById('chat-btn').disabled = false;
  const reply = aiResp || fallbackChatReply(msg);
  addChatMsg('ai', reply);
  MEM.chatHistory.push({ role: 'assistant', content: reply });
}
window.sendChat = sendChat;

function fallbackChatReply(msg) {
  const lower = msg.toLowerCase();
  if(lower.includes('‡¶¨‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ï‡¶Æ‡ßá‡¶á‡¶≤')||lower.includes('blackmail')) return '‡¶¨‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ï‡¶Æ‡ßá‡¶á‡¶≤‡ßá‡¶∞ ‡¶ï‡ßç‡¶∑‡ßá‡¶§‡ßç‡¶∞‡ßá ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡¶∂‡¶ü ‡¶®‡¶ø‡¶®, ‡¶§‡¶æ‡¶∞‡¶™‡¶∞ ‡¶Ö‡¶™‡¶∞‡¶æ‡¶ß‡ßÄ‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶∏‡¶¨ ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶®‡•§ PCSW-‡¶§‡ßá ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®: 01320000888‡•§ ‡¶Æ‡¶®‡ßá ‡¶∞‡¶æ‡¶ñ‡¶¨‡ßá‡¶® ‚Äî ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ï‡ßã‡¶®‡ßã ‡¶¶‡ßã‡¶∑ ‡¶®‡ßá‡¶á‡•§';
  if(lower.includes('‡¶π‡ßç‡¶Ø‡¶æ‡¶ï')||lower.includes('hack')) return '‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶π‡ßç‡¶Ø‡¶æ‡¶ï ‡¶π‡¶≤‡ßá ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶∏‡¶¨ ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶•‡ßá‡¶ï‡ßá ‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®, ‡¶®‡¶§‡ßÅ‡¶® ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶¶‡¶ø‡¶® ‡¶è‡¶¨‡¶Ç 2FA ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§';
  if(lower.includes('‡¶≠‡¶Ø‡¶º')||lower.includes('‡¶ï‡ßÄ ‡¶ï‡¶∞‡¶¨')) return '‡¶Ü‡¶™‡¶®‡¶ø ‡¶è‡¶ï‡¶æ ‡¶®‡¶®‡•§ PCSW-‡¶§‡ßá ‡¶´‡ßã‡¶® ‡¶ï‡¶∞‡ßÅ‡¶® (01320000888) ‚Äî ‡¶§‡¶æ‡¶∞‡¶æ ‡¶∏‡¶æ‡¶π‡¶æ‡¶Ø‡ßç‡¶Ø ‡¶ï‡¶∞‡¶¨‡ßá‡•§';
  return '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ï‡¶•‡¶æ ‡¶∂‡ßÅ‡¶®‡¶õ‡¶ø‡•§ ‡¶Ü‡¶∞‡¶ì ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶¨‡¶≤‡¶≤‡ßá ‡¶∏‡¶†‡¶ø‡¶ï ‡¶™‡¶∞‡¶æ‡¶Æ‡¶∞‡ßç‡¶∂ ‡¶¶‡¶ø‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡•§ ‡¶ï‡ßã‡¶® ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ‡¶Ø‡¶º ‡¶™‡¶°‡¶º‡ßá‡¶õ‡ßá‡¶®?';
}

let typingCounter = 0;
function addTyping() {
  const id = 'typing-' + (++typingCounter);
  const box = document.getElementById('chat-box');
  box.innerHTML += `<div class="msg msg-ai" id="${id}"><div class="msg-ai-icon">ü§ñ</div><div class="msg-ai-bubble"><div class="typing"><span></span><span></span><span></span></div></div></div>`;
  box.scrollTop = box.scrollHeight;
  return id;
}
function removeTyping(id) { document.getElementById(id)?.remove(); }

function addChatMsg(who, text) {
  const box = document.getElementById('chat-box');
  if(who==='ai') {
    box.innerHTML += `<div class="msg msg-ai"><div class="msg-ai-icon">ü§ñ</div><div class="msg-ai-bubble">${text.replace(/\n/g,'<br>')}</div></div>`;
  } else {
    box.innerHTML += `<div class="msg msg-user"><div class="msg-user-bubble">${text}</div></div>`;
  }
  box.scrollTop = box.scrollHeight;
}

document.getElementById('chat-in').addEventListener('keydown', e => { if(e.key==='Enter') sendChat(); });

// ‚îÄ‚îÄ‚îÄ FIREBASE SAVE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function saveToDb(caseId, caseData) {
  try {
    if(typeof window._fbSaveCase !== 'function') return; // Firebase not loaded yet
    await window._fbSaveCase(caseId, caseData);
    document.getElementById('db-save-status').style.display = 'inline-flex';
  } catch(e) {
    // Silent fail ‚Äî data still in memory, user unaffected
    console.warn('DB save failed:', e.message);
  }
}

// ‚îÄ‚îÄ‚îÄ SUBMIT REPORT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function submitReport() {
  const desc = document.getElementById('desc').value.trim();
  const vTypes = [...document.querySelectorAll('#viol-grp input:checked')].map(x => x.value);
  const platforms = [...document.querySelectorAll('#plat-grp input:checked')].map(x => x.value);
  const needs = [...document.querySelectorAll('#need-grp input:checked')].map(x => x.value);

  if(!desc) { toast('‚ö†Ô∏è ‡¶ò‡¶ü‡¶®‡¶æ‡¶∞ ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®'); return; }
  if(!vTypes.length) { toast('‚ö†Ô∏è ‡¶∏‡¶π‡¶ø‡¶Ç‡¶∏‡¶§‡¶æ‡¶∞ ‡¶ß‡¶∞‡¶® ‡¶¨‡ßá‡¶õ‡ßá ‡¶®‡¶ø‡¶®'); return; }

  document.getElementById('loading-overlay').classList.add('on');
  document.getElementById('load-msg').textContent = 'AI ‡¶¨‡¶ø‡¶∂‡ßç‡¶≤‡ßá‡¶∑‡¶£ ‡¶ö‡¶≤‡¶õ‡ßá...';

  const score = computeScore();
  const risk = getRisk(score);
  const caseId = genId();
  const threat = document.querySelector('[name=threat]:checked')?.value || 'no';
  const access = document.querySelector('[name=access]:checked')?.value || 'unsure';
  const known  = document.querySelector('[name=known]:checked')?.value  || 'maybe';
  const dur    = parseInt(document.getElementById('dur').value) || 7;

  document.getElementById('load-msg').textContent = 'AI ‡¶™‡¶∞‡¶æ‡¶Æ‡¶∞‡ßç‡¶∂ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶õ‡ßá...';
  const aiAnalysis = await analyzeIncident(desc, vTypes, risk.label);
  await new Promise(r => setTimeout(r, 400));

  document.getElementById('loading-overlay').classList.remove('on');

  const actions = getActions(score, vTypes, threat, access);
  const safetyGuide = getSafetyGuide(platforms);
  const refs = getRefs(score);
  const factors = buildFactors(score, vTypes, dur, threat, access);

  // Save to in-memory (never browser storage)
  const caseData = {
    caseId, score, riskLevel: risk.level, riskLabel: risk.label,
    vTypes, platforms, dur, threat, access, known, needs,
    evidenceCount: uploadedFiles.length, status: '‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º',
    timestamp: new Date().toLocaleString('bn-BD'),
  };
  MEM.cases[caseId] = caseData;

  // Also save to persistent DB (anonymous, Case ID only)
  await saveToDb(caseId, {
    caseId, riskLevel: risk.level, riskLabel: risk.label, vTypes, platforms,
    evidenceCount: uploadedFiles.length, status: '‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º',
    timestamp: new Date().toISOString(),
  });

  renderResult({ caseId, risk, score, actions, factors, safetyGuide, refs, aiAnalysis, vTypes });
}
window.submitReport = submitReport;

// ‚îÄ‚îÄ‚îÄ RENDER RESULT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderResult({ caseId, risk, score, actions, factors, safetyGuide, refs, aiAnalysis, vTypes }) {
  document.getElementById('tab-report').style.display = 'none';
  document.querySelector('.tabs').style.display = 'none';
  document.getElementById('result').style.display = 'block';
  document.getElementById('result').scrollIntoView({ behavior: 'smooth' });

  document.getElementById('res-caseid').childNodes[0].textContent = caseId + ' ';
  window._caseId = caseId;

  const rb = document.getElementById('res-risk-badge');
  rb.className = risk.cls; rb.textContent = risk.label;
  document.getElementById('res-score').textContent = `‡¶∏‡ßç‡¶ï‡ßã‡¶∞: ${Math.round(score*100)}%`;
  document.getElementById('res-factors').innerHTML = factors.join('<br>') || '‚Ä¢ ‡¶§‡¶•‡ßç‡¶Ø ‡¶¨‡¶ø‡¶∂‡ßç‡¶≤‡ßá‡¶∑‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá';

  if(aiAnalysis) {
    document.getElementById('res-ai-analysis').innerHTML = `
      <div class="ai-analysis-box"><div class="ai-tag">ü§ñ AI ‡¶™‡¶∞‡¶æ‡¶Æ‡¶∞‡ßç‡¶∂</div>${aiAnalysis.replace(/\n/g,'<br>')}</div>`;
  }

  document.getElementById('res-actions').innerHTML = actions.map((a,i) => `
    <div class="action-row"><div class="anum">${i+1}</div><div>${a}</div></div>`).join('');

  // Threat-specific solutions
  const threatSolHtml = buildThreatSolutions(vTypes);
  document.getElementById('res-threat-solutions').innerHTML = threatSolHtml || '<div style="font-size:.8rem;color:var(--muted);">‡¶ï‡ßã‡¶®‡ßã ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡¶ø‡¶∑‡ßç‡¶ü ‡¶π‡ßÅ‡¶Æ‡¶ï‡¶ø‡¶∞ ‡¶ß‡¶∞‡¶® ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§</div>';

  let sh = '';
  for(const g of safetyGuide) {
    sh += `<div style="margin-bottom:13px;"><div style="font-size:.78rem;font-weight:700;color:var(--teal2);margin-bottom:5px;">üì± ${g.pl}</div>`;
    g.steps.forEach((s,i) => sh += `<div class="action-row"><div class="anum">${i+1}</div><div style="font-size:.79rem;">${s}</div></div>`);
    sh += '</div>';
  }
  document.getElementById('res-safety').innerHTML = sh;

  document.getElementById('res-refs').innerHTML = refs.map(r => `
    <div class="ref-card" onclick="window.open('tel:${r.num.replace(/[^0-9]/g,'')}')">
      <span class="ref-icon2">${r.icon}</span>
      <div><div class="ref-name2">${r.name}</div><div class="ref-num">${r.num}</div></div>
      <span class="${r.urgent?'ref-tag-u':'ref-tag-n'}">${r.urgent?'‡¶ú‡¶∞‡ßÅ‡¶∞‡¶ø':'‡¶∏‡¶π‡¶æ‡¶Ø‡¶º‡¶§‡¶æ'}</span>
    </div>`).join('');

  if(uploadedFiles.length > 0) {
    document.getElementById('res-ev-block').style.display = 'block';
    document.getElementById('res-hashes').innerHTML = uploadedFiles.map(f => `
      <div class="hash-row">üìé ${f.name}<br>SHA-256: ${f.hash}<br>Blockchain: ${f.blockRef}</div>`).join('');
  }
}

function copyId() {
  navigator.clipboard.writeText(window._caseId || '').catch(()=>{});
  toast('‚úÖ Case ID ‡¶ï‡¶™‡¶ø ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!');
}
window.copyId = copyId;

function newReport() {
  document.getElementById('result').style.display = 'none';
  document.getElementById('tab-report').style.display = 'block';
  document.querySelector('.tabs').style.display = 'flex';
  document.getElementById('desc').value = '';
  document.querySelectorAll('.check-item input').forEach(x => x.checked = false);
  document.querySelectorAll('.check-item').forEach(x => x.classList.remove('on'));
  document.querySelectorAll('.radio-opt').forEach(x => x.classList.remove('on'));
  uploadedFiles = []; renderFiles();
  document.getElementById('live-risk').style.display = 'none';
  document.getElementById('db-save-status').style.display = 'none';
  window.scrollTo({ top: 0, behavior: 'smooth' });
}
window.newReport = newReport;

// ‚îÄ‚îÄ‚îÄ TRACK CASE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function trackCase() {
  const id = document.getElementById('track-in').value.trim().toUpperCase();
  const res = document.getElementById('track-res');
  if(!id) { toast('Case ID ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®'); return; }

  // ‡ßß. In-memory cache ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®
  let c = MEM.cases[id];

  // ‡ß®. Firebase Firestore ‡¶•‡ßá‡¶ï‡ßá ‡¶ñ‡ßã‡¶Å‡¶ú
  if(!c && typeof window._fbGetCase === 'function') {
    try {
      res.style.display = 'block';
      res.innerHTML = '<span style="color:var(--muted)"><span class="spin-sm-inline"></span> ‡¶ñ‡ßã‡¶Å‡¶ú‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</span>';
      c = await window._fbGetCase(id);
    } catch(e) {}
  }

  if(!c) {
    res.style.display = 'block';
    res.innerHTML = '<span style="color:var(--muted)">‚ùå ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§ ‡¶∏‡¶†‡¶ø‡¶ï ID ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</span>';
    return;
  }

  const ts = c.savedAt?.toDate?.()?.toLocaleString('bn-BD') || c.timestamp || '‚Äî';
  const sc = c.status==='‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶® ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá'?'tb-resolved':c.status==='‡¶™‡¶∞‡ßç‡¶Ø‡¶æ‡¶≤‡ßã‡¶ö‡¶®‡¶æ‡¶ß‡ßÄ‡¶®'?'tb-review':'tb-active';
  res.style.display = 'block';
  res.innerHTML = `
    <div style="display:flex;align-items:center;gap:7px;margin-bottom:8px;">
      <strong style="font-family:var(--mono);color:var(--teal2);">${c.caseId}</strong>
      <span class="track-badge ${sc}">${c.status}</span>
    </div>
    <div style="font-size:.79rem;color:var(--text2);line-height:1.75;">
      üìÖ ‡¶ú‡¶Æ‡¶æ‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: ${ts}<br>
      ‚ö†Ô∏è ‡¶ù‡ßÅ‡¶Å‡¶ï‡¶ø: <strong>${c.riskLabel}</strong><br>
      üìÅ ‡¶™‡ßç‡¶∞‡¶Æ‡¶æ‡¶£: ${c.evidenceCount}‡¶ü‡¶ø ‡¶´‡¶æ‡¶á‡¶≤<br>
      üìã ‡¶ß‡¶∞‡¶®: ${(c.vTypes||[]).join(', ')||'‡¶â‡¶≤‡ßç‡¶≤‡ßá‡¶ñ ‡¶®‡ßá‡¶á'}
    </div>`;
}
window.trackCase = trackCase;

// ‚îÄ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function toast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg; t.classList.add('on');
  setTimeout(() => t.classList.remove('on'), 2400);
}

// ‚îÄ‚îÄ‚îÄ INITIAL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
updDur(document.getElementById('dur'));
setTimeout(() => { document.title = '‡¶∏‡ßÅ‡¶∞‡¶ï‡ßç‡¶∑‡¶æ | ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶¶ ‡¶∏‡¶π‡¶æ‡¶Ø‡¶º‡¶§‡¶æ ‡¶™‡ßã‡¶∞‡ßç‡¶ü‡¶æ‡¶≤'; }, 800);

})(); // END IIFE ‚Äî hides all variables from global scope
</script>
</body>
</html>
